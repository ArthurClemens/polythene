{"version":3,"sources":["slider.es6"],"names":["CSS_CLASSES","block","thumb","label","track","trackPart","trackPartValue","trackPartRest","trackBar","trackBarValue","control","ticks","tick","pin","isDisabled","isActive","hasTrack","hasPin","hasFocus","isAtMin","hasTicks","focusElement","eventMoveType","eventEndType","isClient","window","PointerEvent","DocumentTouch","document","deFocus","blur","ctrl","focus","el","positionFromEvent","isTouch","isVertical","e","touches","pageY","pageX","updatePinPosition","controlEl","pinEl","fraction","rangeWidth","style","left","updateValue","setValue","value","generateTickMarks","Math","round","max","min","stepSize","steps","items","push","readRangeData","controlWidth","thumb_size","trackEl","getBoundingClientRect","width","getComputedStyle","rangeOffset","parseFloat","styles","marginLeft","calculateClickOffset","clickOffset","controlOffset","initControlEvent","eventPos","controlPos","initTrackEvent","handlePosEvent","pos","redraw","startDrag","isServer","isDragging","preventDefault","drag","endDrag","removeEventListener","addEventListener","opts","startTrack","createSlider","parseInt","step","onStartTrack","onInitDrag","flexRestValue","Object","assign","class","config","inited","setTimeout","disabled","onmousedown","interactiveTrack","ontouchstart","flex","flexValueCss","webkitFlex","tabindex","onfocus","onblur","onkeydown","which","decrease","shiftKey","increase","events","stepCount","icon","flexRestCss","createView","tag","join","id","props","before","content","after","component","controller","defaultValue","v","getValue","multiply","view"],"mappings":"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","file":"slider.js","sourcesContent":["import 'polythene/common/object.assign';\nimport p from 'polythene/polythene/polythene';\nimport m from 'mithril';\nimport 'polythene/slider/theme/theme';\nimport themeConfig from 'polythene/slider/theme/config';\nimport isomorphic from 'polythene/common/isomorphic';\n\nconst CSS_CLASSES = {\n    block: 'pe-slider',\n    thumb: 'pe-slider__thumb',\n    label: 'pe-slider__label',\n    track: 'pe-slider__track',\n    trackPart: 'pe-slider__track-part',\n    trackPartValue: 'pe-slider__track-value',\n    trackPartRest: 'pe-slider__track-rest',\n    trackBar: 'pe-slider__track-bar',\n    trackBarValue: 'pe-slider__track-bar-value',\n\n    control: 'pe-slider__control',\n    ticks: 'pe-slider__ticks',\n    tick: 'pe-slider__ticks-tick',\n    pin: 'pe-slider__pin',\n\n    isDisabled: 'pe-slider--disabled',\n    isActive: 'pe-slider--active',\n    hasTrack: 'pe-slider--track',\n    hasPin: 'pe-slider--pin',\n    hasFocus: 'pe-slider--focus',\n    isAtMin: 'pe-slider--min',\n    hasTicks: 'pe-slider--ticks'\n};\n\nlet focusElement;\n\n// const eventStartType = window.PointerEvent ? 'pointerdown' : (('ontouchstart' in window) || window.DocumentTouch && document instanceof DocumentTouch) ? 'touchstart' : 'mousedown';\nlet eventMoveType = 'mousemove';\nlet eventEndType = 'mouseup';\nif(isomorphic.isClient()){\n\teventMoveType = window.PointerEvent ? 'pointermove' : (('ontouchmove' in window) || window.DocumentTouch && document instanceof DocumentTouch) ? 'touchmove' : 'mousemove';\n\teventEndType = window.PointerEvent ? 'pointerup' : (('ontouchend' in window) || window.DocumentTouch && document instanceof DocumentTouch) ? 'touchend' : 'mouseup';\n}\n\nconst deFocus = (ctrl) => {\n    if (focusElement) {\n        focusElement.blur();\n    }\n    focusElement = undefined;\n    ctrl.hasFocus = false;\n};\n\nconst focus = (ctrl, el) => {\n    deFocus(ctrl);\n    focusElement = el;\n    ctrl.hasFocus = true;\n};\n\nconst positionFromEvent = (e, isVertical) => {\n    if (p.isTouch) {\n        return isVertical ? e.touches[0].pageY : e.touches[0].pageX;\n    } else {\n        return isVertical ? e.pageY : e.pageX;\n    }\n};\n\nconst updatePinPosition = (ctrl) => {\n    if (ctrl.controlEl && ctrl.pinEl) {\n        const left = ctrl.fraction() * ctrl.rangeWidth;\n        ctrl.pinEl.style.left = left + 'px';\n    }\n};\n\nconst updateValue = (ctrl, value) => {\n    ctrl.setValue(value);\n    updatePinPosition(ctrl);\n};\n\nconst generateTickMarks = (min, max, stepSize) => {\n    const steps = Math.round((max - min) / stepSize);\n    const items = [];\n    let s = steps + 1;\n    while (s > 0) {\n        items.push(m('div', {class: CSS_CLASSES.tick}));\n        s--;\n    }\n    return items;\n};\n\nconst readRangeData = (ctrl) => {\n    if (ctrl.controlEl) {\n        // range is from the far left to the far right minus the thumb width (max x is at the left side of the thumb)\n        ctrl.controlWidth = themeConfig.thumb_size;\n        ctrl.rangeWidth = ctrl.trackEl.getBoundingClientRect().width - ctrl.controlWidth;\n        const styles = window.getComputedStyle(ctrl.trackEl);\n        ctrl.rangeOffset = parseFloat(styles.marginLeft);\n    }\n};\n\nconst calculateClickOffset = (ctrl, controlOffset = 0) => {\n    ctrl.clickOffset = ctrl.trackEl.getBoundingClientRect().left - (ctrl.rangeOffset - ctrl.controlWidth / 2) + controlOffset;\n};\n\nconst initControlEvent = (ctrl, e) => {\n    const controlPos = ctrl.controlEl.getBoundingClientRect().left;\n    const eventPos = positionFromEvent(e);\n    const controlOffset = eventPos - controlPos - ctrl.controlWidth / 2;\n    calculateClickOffset(ctrl, controlOffset);\n};\n\nconst initTrackEvent = (ctrl) => {\n    calculateClickOffset(ctrl, 0);\n};\n\nconst handlePosEvent = (ctrl, e) => {\n    const pos = positionFromEvent(e) - ctrl.clickOffset;\n    const value = ctrl.min + ((pos - ctrl.rangeOffset) / ctrl.rangeWidth) * (ctrl.max - ctrl.min);\n    updateValue(ctrl, value);\n    m.redraw();\n};\n\nconst startDrag = (ctrl, opts, e) => {\n\tif(isomorphic.isServer()) {\n\t\treturn;\n\t}\n    if (ctrl.isDragging) return;\n    e.preventDefault();\n    ctrl.isDragging = true;\n    ctrl.isActive = true;\n    deFocus(ctrl);\n\n    const drag = (e) => {\n        if (!ctrl.isDragging) return;\n        handlePosEvent(ctrl, e);\n    };\n\n    const endDrag = () => {\n        if (!ctrl.isDragging) return;\n        ctrl.isDragging = false;\n        ctrl.isActive = false;\n        deFocus(ctrl);\n        window.removeEventListener(eventMoveType, drag);\n        window.removeEventListener(eventEndType, endDrag);\n        m.redraw();\n    };\n\n    window.addEventListener(eventMoveType, drag);\n    window.addEventListener(eventEndType, endDrag);\n\n    readRangeData(ctrl);\n\n    if (opts.pin) {\n        updatePinPosition(ctrl);\n    }\n};\n\nconst startTrack = (ctrl, opts, e) => {\n    e.preventDefault();\n    if (ctrl.isDragging) return;\n    readRangeData(ctrl);\n    initTrackEvent(ctrl);\n    handlePosEvent(ctrl, e);\n    startDrag(ctrl, opts, e);\n};\n\nconst createSlider = (ctrl, opts = {}, hasTicks, interactiveTrack) => {\n    const fraction = ctrl.fraction();\n    const stepCount = Math.max(10, parseInt(opts.step, 10) || 1); // not more than 100 steps on the screen\n\n    const onStartTrack = (e) => {\n        startTrack(ctrl, opts, e);\n    };\n\n    const onInitDrag = (e) => {\n        readRangeData(ctrl);\n        initControlEvent(ctrl, e);\n        startDrag(ctrl, opts, e);\n    };\n\n    const flexValueCss = fraction + ' 1 0%';\n    const flexRestValue = (1 - fraction);\n    const flexRestCss = flexRestValue + ' 1 0%';\n\n    return [\n        m('div', Object.assign({}, {\n            class: CSS_CLASSES.track,\n            config: (el, inited) => {\n                if (inited) return;\n                ctrl.trackEl = el;\n                if (opts.pin) {\n                    setTimeout(() => {\n                        updatePinPosition(ctrl);\n                    }, 0);\n                }\n            }\n        }, (interactiveTrack && !opts.disabled && !p.isTouch) ? {\n            onmousedown: onStartTrack\n        } : null, (interactiveTrack && !opts.disabled && p.isTouch) ? {\n            ontouchstart: onStartTrack\n        } : null), [\n            m('div',\n                {\n                    class: CSS_CLASSES.trackPart + ' ' + CSS_CLASSES.trackPartValue,\n                    style: {\n                        flex: flexValueCss,\n                        '-ms-flex': flexValueCss,\n                        webkitFlex: flexValueCss\n                    }\n                },\n                m('div', {class: CSS_CLASSES.trackBar},\n                    m('div', {class: CSS_CLASSES.trackBarValue})\n                )\n            ),\n            m('div', Object.assign({},\n                {\n                    class: CSS_CLASSES.control,\n                    config: (el, inited) => {\n                        if (inited) return;\n                        ctrl.controlEl = el;\n                    }\n                }, opts.disabled ? {\n                    disabled: true\n                } : {\n                    tabindex: opts.tabindex || 0,\n                    onfocus: () => {\n                        focus(ctrl, ctrl.controlEl);\n                    },\n                    onblur: () => {\n                        deFocus(ctrl);\n                    },\n                    onkeydown: (e) => {\n                        if (e.which === 27) {\n                            // ESCAPE\n                            ctrl.controlEl.blur(e);\n                        } else if (e.which === 37) {\n                            // LEFT\n                            ctrl.decrease(e.shiftKey);\n                        } else if (e.which === 38) {\n                            // UP\n                            ctrl.increase(e.shiftKey);\n                        } else if (e.which === 39) {\n                            // RIGHT\n                            ctrl.increase(e.shiftKey);\n                        } else if (e.which === 40) {\n                            // DOWN\n                            ctrl.decrease(e.shiftKey);\n                        }\n                        readRangeData(ctrl);\n                        updatePinPosition(ctrl);\n                    }\n                },\n                (!opts.disabled && !p.isTouch) ? {\n                    onmousedown: onInitDrag\n                } : null,\n                (!opts.disabled && p.isTouch) ? {\n                    ontouchstart: onInitDrag\n                } : null,\n                opts.events ? opts.events : null,\n                hasTicks ? {\n                    step: stepCount\n                } : null\n            ), opts.icon ? m('div', {class: CSS_CLASSES.thumb}, opts.icon) : null),\n            m('div',\n                {\n                    class: CSS_CLASSES.trackPart + ' ' + CSS_CLASSES.trackPartRest,\n                    style: {\n                        flex: flexRestCss,\n                        '-ms-flex': flexRestCss,\n                        webkitFlex: flexRestCss,\n                        'max-width': (flexRestValue * 100) + '%' // for IE Edge\n                    }\n                },\n                m('div', {class: CSS_CLASSES.trackBar},\n                    m('div', {class: CSS_CLASSES.trackBarValue})\n                )\n            ),\n            (hasTicks && !opts.disabled) ? m('div', {class: CSS_CLASSES.ticks}, generateTickMarks(ctrl.min, ctrl.max, stepCount)) : null,\n            (hasTicks && opts.pin && !opts.disabled) ? m('div', {\n                class: CSS_CLASSES.pin,\n                value: Math.round(ctrl.value()),\n                config: (el, inited) => {\n                    if (inited) return;\n                    ctrl.pinEl = el;\n                }\n            }) : null\n        ])\n    ];\n};\n\nconst createView = (ctrl, opts = {}) => {\n    if (typeof opts.value === 'function') {\n        ctrl.setValue(opts.value());\n    }\n    const tag = opts.tag || 'div';\n    const hasTicks = opts.ticks !== undefined && opts.ticks !== false;\n    const interactiveTrack = (opts.interactiveTrack !== undefined) ? opts.interactiveTrack : true;\n    const props = {\n        class: [\n            CSS_CLASSES.block,\n            (opts.disabled ? CSS_CLASSES.isDisabled : null),\n            (opts.pin ? CSS_CLASSES.hasPin : null),\n            (interactiveTrack ? CSS_CLASSES.hasTrack : null),\n            (ctrl.isActive ? CSS_CLASSES.isActive : null),\n            (ctrl.hasFocus ? CSS_CLASSES.hasFocus : null),\n            (ctrl.fraction() === 0 ? CSS_CLASSES.isAtMin : null),\n            (hasTicks ? CSS_CLASSES.hasTicks : null),\n            opts.class\n        ].join(' '),\n        id: opts.id || '',\n        config: opts.config\n    };\n    const content = createSlider(ctrl, opts, hasTicks, interactiveTrack);\n    return m(tag, props, [opts.before, content, opts.after]);\n};\n\nconst component = {\n    controller: (opts = {}) => {\n        const min = (opts.min !== undefined) ? opts.min : 0;\n        const max = (opts.max !== undefined) ? opts.max : 100;\n        const step = (opts.step !== undefined) ? opts.step : 1;\n        const defaultValue = 0;\n        let fraction = min;\n        let value = defaultValue;\n\n        if (typeof opts.value === 'function') {\n            const v = opts.value();\n            value = (v !== undefined) ? v : defaultValue;\n        } else {\n            value = (opts.value !== undefined) ? opts.value : defaultValue;\n        }\n\n        const setValue = (v) => {\n            if (v < min) v = min;\n            if (v > max) v = max;\n            value = step ? (Math.round(v / step) * step) : v;\n            fraction = (value - min) / (max - min);\n            if (opts.getValue) {\n                opts.getValue(value);\n            }\n        };\n\n        setValue(value);\n\n        return {\n            min,\n            max,\n            trackEl: null,\n            controlEl: null,\n            pinEl: null,\n            setValue,\n            value: () => (value),\n            fraction: () => (fraction),\n            increase: (multiply) => (setValue(value + (multiply ? 10 : 1) * (step || 1))),\n            decrease: (multiply) => (setValue(value - (multiply ? 10 : 1) * (step || 1))),\n            isActive: false,\n            hasFocus: false,\n            isDragging: false,\n            // coordinates\n            controlWidth: 0,\n            rangeWidth: 0,\n            rangeOffset: 0,\n            clickOffset: 0\n        };\n    },\n    view: (ctrl, opts = {}) => {\n        return createView(ctrl, opts);\n    }\n};\n\nexport default component;\n"]}