{"version":3,"file":"polythene-mithril-base.js","sources":["../src/keys.js","../src/renderer.js","../node_modules/mithril/stream/stream.js","../node_modules/mithril/stream.js","../src/StateComponent.js","../src/ViewComponent.js"],"sourcesContent":["\nexport const keys = {\n  autocomplete: \"autocomplete\",\n  autofocus:    \"autofocus\",\n  class:        \"class\",\n  className:    \"class\",\n  enctype:      \"enctype\",\n  formaction:   \"formaction\",\n  maxlength:    \"maxlength\",\n  minlength:    \"minlength\",\n  onblur:       \"onblur\",\n  onchange:     \"onchange\",\n  onclick:      \"onclick\",\n  onfocus:      \"onfocus\",\n  oninput:      \"oninput\",\n  onkeydown:    \"onkeydown\",\n  onkeyup:      \"onkeyup\",\n  onmousedown:  \"onmousedown\",\n  onmouseout:   \"onmouseout\",\n  onmouseover:  \"onmouseover\",\n  onmouseup:    \"onmouseup\",\n  onscroll:     \"onscroll\",\n  onsubmit:     \"onsubmit\",\n  ontouchend:   \"ontouchend\",\n  ontouchmove:  \"ontouchmove\",\n  ontouchstart: \"ontouchstart\",\n  readonly:     \"readonly\",\n  tabindex:     \"tabindex\",\n};\n\nexport const normalizeKey = key => key.toLowerCase();\n","import m from \"mithril\";\n\nexport const renderer = m;\nrenderer.displayName = \"mithril\";\n","/* eslint-disable */\n;(function() {\n\"use strict\"\n/* eslint-enable */\n\nvar guid = 0, HALT = {}\nfunction createStream() {\n\tfunction stream() {\n\t\tif (arguments.length > 0 && arguments[0] !== HALT) updateStream(stream, arguments[0])\n\t\treturn stream._state.value\n\t}\n\tinitStream(stream)\n\n\tif (arguments.length > 0 && arguments[0] !== HALT) updateStream(stream, arguments[0])\n\n\treturn stream\n}\nfunction initStream(stream) {\n\tstream.constructor = createStream\n\tstream._state = {id: guid++, value: undefined, state: 0, derive: undefined, recover: undefined, deps: {}, parents: [], endStream: undefined, unregister: undefined}\n\tstream.map = stream[\"fantasy-land/map\"] = map, stream[\"fantasy-land/ap\"] = ap, stream[\"fantasy-land/of\"] = createStream\n\tstream.valueOf = valueOf, stream.toJSON = toJSON, stream.toString = valueOf\n\n\tObject.defineProperties(stream, {\n\t\tend: {get: function() {\n\t\t\tif (!stream._state.endStream) {\n\t\t\t\tvar endStream = createStream()\n\t\t\t\tendStream.map(function(value) {\n\t\t\t\t\tif (value === true) {\n\t\t\t\t\t\tunregisterStream(stream)\n\t\t\t\t\t\tendStream._state.unregister = function(){unregisterStream(endStream)}\n\t\t\t\t\t}\n\t\t\t\t\treturn value\n\t\t\t\t})\n\t\t\t\tstream._state.endStream = endStream\n\t\t\t}\n\t\t\treturn stream._state.endStream\n\t\t}}\n\t})\n}\nfunction updateStream(stream, value) {\n\tupdateState(stream, value)\n\tfor (var id in stream._state.deps) updateDependency(stream._state.deps[id], false)\n\tif (stream._state.unregister != null) stream._state.unregister()\n\tfinalize(stream)\n}\nfunction updateState(stream, value) {\n\tstream._state.value = value\n\tstream._state.changed = true\n\tif (stream._state.state !== 2) stream._state.state = 1\n}\nfunction updateDependency(stream, mustSync) {\n\tvar state = stream._state, parents = state.parents\n\tif (parents.length > 0 && parents.every(active) && (mustSync || parents.some(changed))) {\n\t\tvar value = stream._state.derive()\n\t\tif (value === HALT) return false\n\t\tupdateState(stream, value)\n\t}\n}\nfunction finalize(stream) {\n\tstream._state.changed = false\n\tfor (var id in stream._state.deps) stream._state.deps[id]._state.changed = false\n}\n\nfunction combine(fn, streams) {\n\tif (!streams.every(valid)) throw new Error(\"Ensure that each item passed to stream.combine/stream.merge is a stream\")\n\treturn initDependency(createStream(), streams, function() {\n\t\treturn fn.apply(this, streams.concat([streams.filter(changed)]))\n\t})\n}\n\nfunction initDependency(dep, streams, derive) {\n\tvar state = dep._state\n\tstate.derive = derive\n\tstate.parents = streams.filter(notEnded)\n\n\tregisterDependency(dep, state.parents)\n\tupdateDependency(dep, true)\n\n\treturn dep\n}\nfunction registerDependency(stream, parents) {\n\tfor (var i = 0; i < parents.length; i++) {\n\t\tparents[i]._state.deps[stream._state.id] = stream\n\t\tregisterDependency(stream, parents[i]._state.parents)\n\t}\n}\nfunction unregisterStream(stream) {\n\tfor (var i = 0; i < stream._state.parents.length; i++) {\n\t\tvar parent = stream._state.parents[i]\n\t\tdelete parent._state.deps[stream._state.id]\n\t}\n\tfor (var id in stream._state.deps) {\n\t\tvar dependent = stream._state.deps[id]\n\t\tvar index = dependent._state.parents.indexOf(stream)\n\t\tif (index > -1) dependent._state.parents.splice(index, 1)\n\t}\n\tstream._state.state = 2 //ended\n\tstream._state.deps = {}\n}\n\nfunction map(fn) {return combine(function(stream) {return fn(stream())}, [this])}\nfunction ap(stream) {return combine(function(s1, s2) {return s1()(s2())}, [stream, this])}\nfunction valueOf() {return this._state.value}\nfunction toJSON() {return this._state.value != null && typeof this._state.value.toJSON === \"function\" ? this._state.value.toJSON() : this._state.value}\n\nfunction valid(stream) {return stream._state }\nfunction active(stream) {return stream._state.state === 1}\nfunction changed(stream) {return stream._state.changed}\nfunction notEnded(stream) {return stream._state.state !== 2}\n\nfunction merge(streams) {\n\treturn combine(function() {\n\t\treturn streams.map(function(s) {return s()})\n\t}, streams)\n}\n\nfunction scan(reducer, seed, stream) {\n\tvar newStream = combine(function (s) {\n\t\treturn seed = reducer(seed, s._state.value)\n\t}, [stream])\n\n\tif (newStream._state.state === 0) newStream(seed)\n\n\treturn newStream\n}\n\nfunction scanMerge(tuples, seed) {\n\tvar streams = tuples.map(function(tuple) {\n\t\tvar stream = tuple[0]\n\t\tif (stream._state.state === 0) stream(undefined)\n\t\treturn stream\n\t})\n\n\tvar newStream = combine(function() {\n\t\tvar changed = arguments[arguments.length - 1]\n\n\t\tstreams.forEach(function(stream, idx) {\n\t\t\tif (changed.indexOf(stream) > -1) {\n\t\t\t\tseed = tuples[idx][1](seed, stream._state.value)\n\t\t\t}\n\t\t})\n\n\t\treturn seed\n\t}, streams)\n\n\treturn newStream\n}\n\ncreateStream[\"fantasy-land/of\"] = createStream\ncreateStream.merge = merge\ncreateStream.combine = combine\ncreateStream.scan = scan\ncreateStream.scanMerge = scanMerge\ncreateStream.HALT = HALT\n\nif (typeof module !== \"undefined\") module[\"exports\"] = createStream\nelse if (typeof window.m === \"function\" && !(\"stream\" in window.m)) window.m.stream = createStream\nelse window.m = {stream : createStream}\n\n}());\n","\"use strict\"\n\nmodule.exports = require(\"./stream/stream\")\n","import stream from \"mithril/stream\";\nimport { renderer } from \"./renderer\";\nimport { keys } from \"./keys\";\n\nconst requiresKeys = false;\n\nexport const StateComponent = ({\n  createContent = () => {},\n  createProps = () => {},\n  component = null,\n  getElement = () => \"div\",\n  getInitialState = () => ({}),\n  onMount = () => {},\n  onUnMount = () => {},\n  onUpdate = () => {},\n  view = null\n}) => {\n\n  const oninit = vnode => {\n    const protoState = Object.assign(\n      {},\n      vnode\n    );\n    const initialState = getInitialState(protoState, stream, { keys });\n    Object.assign(vnode.state, initialState);\n    vnode._mounted = false;\n\n    vnode.state.redrawOnUpdate && vnode.state.redrawOnUpdate.map(() => (\n      vnode._mounted && setTimeout(renderer.redraw)\n    ));\n  };\n\n  const oncreate = vnode => {\n    vnode._mounted = true;\n    onMount(vnode, { keys });\n  };\n\n  const render = vnode => {\n    return renderer(\n      component || getElement(vnode),\n      createProps(vnode, { renderer, requiresKeys, keys }),\n      [\n        vnode.attrs.before,\n        createContent(vnode, { renderer, requiresKeys, keys }),\n        vnode.attrs.after\n      ]\n    );\n  };\n\n  return {\n    view: view\n      ? vnode => view(vnode, { render, renderer })\n      : vnode => render(vnode),\n    oninit,\n    oncreate,\n    onremove: onUnMount,\n    onupdate: onUpdate,\n  };\n};\n","import { renderer } from \"./renderer\";\nimport { keys } from \"./keys\";\n\nconst requiresKeys = false;\n\nexport const ViewComponent = ({\n  createContent = () => {},\n  createProps = () => {},\n  getElement = () => \"div\",\n  component = null,\n  view = null,\n  onMount = () => {},\n  onUnMount = () => {},\n}) => {\n\n  const render = vnode =>\n    renderer(\n      component || getElement(vnode),\n      createProps(vnode, { renderer, requiresKeys, keys }),\n      [\n        vnode.attrs.before,\n        createContent(vnode, { renderer, requiresKeys, keys }),\n        vnode.attrs.after\n      ]\n    );\n\n  return {\n    view: view\n      ? vnode => view(vnode, { render, renderer })\n      : vnode => render(vnode),\n    oncreate: vnode => onMount(vnode, { keys }),\n    onremove: onUnMount\n  };\n};\n"],"names":["keys","autocomplete","autofocus","class","className","enctype","formaction","maxlength","minlength","onblur","onchange","onclick","onfocus","oninput","onkeydown","onkeyup","onmousedown","onmouseout","onmouseover","onmouseup","onscroll","onsubmit","ontouchend","ontouchmove","ontouchstart","readonly","tabindex","renderer","m","displayName","guid","HALT","createStream","stream","arguments","length","updateStream","_state","value","initStream","constructor","id","undefined","state","derive","recover","deps","parents","endStream","unregister","map","ap","valueOf","toJSON","toString","Object","defineProperties","end","get","unregisterStream","updateState","updateDependency","finalize","changed","mustSync","every","active","some","combine","fn","streams","valid","Error","initDependency","apply","concat","filter","dep","notEnded","registerDependency","i","parent","dependent","index","indexOf","splice","s1","s2","merge","s","scan","reducer","seed","newStream","scanMerge","tuples","tuple","forEach","idx","module","require$$0","requiresKeys","StateComponent","createContent","createProps","component","getElement","getInitialState","onMount","onUnMount","onUpdate","view","oninit","protoState","vnode","initialState","_mounted","redrawOnUpdate","setTimeout","redraw","oncreate","render","attrs","before","after","onremove","onupdate","ViewComponent"],"mappings":";;;;;;;;MACaA,OAAO;EAClBC,gBAAc,cADI;EAElBC,aAAc,WAFI;EAGlBC,SAAc,OAHI;EAIlBC,aAAc,OAJI;EAKlBC,WAAc,SALI;EAMlBC,cAAc,YANI;EAOlBC,aAAc,WAPI;EAQlBC,aAAc,WARI;EASlBC,UAAc,QATI;EAUlBC,YAAc,UAVI;EAWlBC,WAAc,SAXI;EAYlBC,WAAc,SAZI;EAalBC,WAAc,SAbI;EAclBC,aAAc,WAdI;EAelBC,WAAc,SAfI;EAgBlBC,eAAc,aAhBI;EAiBlBC,cAAc,YAjBI;EAkBlBC,eAAc,aAlBI;EAmBlBC,aAAc,WAnBI;EAoBlBC,YAAc,UApBI;EAqBlBC,YAAc,UArBI;EAsBlBC,cAAc,YAtBI;EAuBlBC,eAAc,aAvBI;EAwBlBC,gBAAc,cAxBI;EAyBlBC,YAAc,UAzBI;EA0BlBC,YAAc;EA1BI,CAAb;;MCCMC,WAAWC,CAAjB;EACPD,SAASE,WAAT,GAAuB,SAAvB;;;;;;;ACHA,EACE,aAAW;AACb;;EAGA,MAAIC,OAAO,CAAX;EAAA,MAAcC,OAAO,EAArB;EACA,WAASC,YAAT,GAAwB;EACvB,YAASC,MAAT,GAAkB;EACjB,QAAIC,UAAUC,MAAV,GAAmB,CAAnB,IAAwBD,UAAU,CAAV,MAAiBH,IAA7C,EAAmDK,aAAaH,MAAb,EAAqBC,UAAU,CAAV,CAArB;EACnD,WAAOD,OAAOI,MAAP,CAAcC,KAArB;EACA;EACDC,cAAWN,MAAX;;EAEA,OAAIC,UAAUC,MAAV,GAAmB,CAAnB,IAAwBD,UAAU,CAAV,MAAiBH,IAA7C,EAAmDK,aAAaH,MAAb,EAAqBC,UAAU,CAAV,CAArB;;EAEnD,UAAOD,MAAP;EACA;EACD,WAASM,UAAT,CAAoBN,MAApB,EAA4B;EAC3BA,UAAOO,WAAP,GAAqBR,YAArB;EACAC,UAAOI,MAAP,GAAgB,EAACI,IAAIX,MAAL,EAAaQ,OAAOI,SAApB,EAA+BC,OAAO,CAAtC,EAAyCC,QAAQF,SAAjD,EAA4DG,SAASH,SAArE,EAAgFI,MAAM,EAAtF,EAA0FC,SAAS,EAAnG,EAAuGC,WAAWN,SAAlH,EAA6HO,YAAYP,SAAzI,EAAhB;EACAT,UAAOiB,GAAP,GAAajB,OAAO,kBAAP,IAA6BiB,GAA1C,EAA+CjB,OAAO,iBAAP,IAA4BkB,EAA3E,EAA+ElB,OAAO,iBAAP,IAA4BD,YAA3G;EACAC,UAAOmB,OAAP,GAAiBA,OAAjB,EAA0BnB,OAAOoB,MAAP,GAAgBA,MAA1C,EAAkDpB,OAAOqB,QAAP,GAAkBF,OAApE;;EAEAG,UAAOC,gBAAP,CAAwBvB,MAAxB,EAAgC;EAC/BwB,SAAK,EAACC,KAAK,eAAW;EACrB,UAAI,CAACzB,OAAOI,MAAP,CAAcW,SAAnB,EAA8B;EAC7B,WAAIA,YAAYhB,cAAhB;EACAgB,iBAAUE,GAAV,CAAc,UAASZ,KAAT,EAAgB;EAC7B,YAAIA,UAAU,IAAd,EAAoB;EACnBqB,0BAAiB1B,MAAjB;EACAe,mBAAUX,MAAV,CAAiBY,UAAjB,GAA8B,YAAU;EAACU,2BAAiBX,SAAjB;EAA4B,UAArE;EACA;EACD,eAAOV,KAAP;EACA,QAND;EAOAL,cAAOI,MAAP,CAAcW,SAAd,GAA0BA,SAA1B;EACA;EACD,aAAOf,OAAOI,MAAP,CAAcW,SAArB;EACA,MAbI;EAD0B,IAAhC;EAgBA;EACD,WAASZ,YAAT,CAAsBH,MAAtB,EAA8BK,KAA9B,EAAqC;EACpCsB,eAAY3B,MAAZ,EAAoBK,KAApB;EACA,QAAK,IAAIG,EAAT,IAAeR,OAAOI,MAAP,CAAcS,IAA7B;EAAmCe,qBAAiB5B,OAAOI,MAAP,CAAcS,IAAd,CAAmBL,EAAnB,CAAjB,EAAyC,KAAzC;EAAnC,IACA,IAAIR,OAAOI,MAAP,CAAcY,UAAd,IAA4B,IAAhC,EAAsChB,OAAOI,MAAP,CAAcY,UAAd;EACtCa,YAAS7B,MAAT;EACA;EACD,WAAS2B,WAAT,CAAqB3B,MAArB,EAA6BK,KAA7B,EAAoC;EACnCL,UAAOI,MAAP,CAAcC,KAAd,GAAsBA,KAAtB;EACAL,UAAOI,MAAP,CAAc0B,OAAd,GAAwB,IAAxB;EACA,OAAI9B,OAAOI,MAAP,CAAcM,KAAd,KAAwB,CAA5B,EAA+BV,OAAOI,MAAP,CAAcM,KAAd,GAAsB,CAAtB;EAC/B;EACD,WAASkB,gBAAT,CAA0B5B,MAA1B,EAAkC+B,QAAlC,EAA4C;EAC3C,OAAIrB,QAAQV,OAAOI,MAAnB;EAAA,OAA2BU,UAAUJ,MAAMI,OAA3C;EACA,OAAIA,QAAQZ,MAAR,GAAiB,CAAjB,IAAsBY,QAAQkB,KAAR,CAAcC,MAAd,CAAtB,KAAgDF,YAAYjB,QAAQoB,IAAR,CAAaJ,OAAb,CAA5D,CAAJ,EAAwF;EACvF,QAAIzB,QAAQL,OAAOI,MAAP,CAAcO,MAAd,EAAZ;EACA,QAAIN,UAAUP,IAAd,EAAoB,OAAO,KAAP;EACpB6B,gBAAY3B,MAAZ,EAAoBK,KAApB;EACA;EACD;EACD,WAASwB,QAAT,CAAkB7B,MAAlB,EAA0B;EACzBA,UAAOI,MAAP,CAAc0B,OAAd,GAAwB,KAAxB;EACA,QAAK,IAAItB,EAAT,IAAeR,OAAOI,MAAP,CAAcS,IAA7B;EAAmCb,WAAOI,MAAP,CAAcS,IAAd,CAAmBL,EAAnB,EAAuBJ,MAAvB,CAA8B0B,OAA9B,GAAwC,KAAxC;EAAnC;EACA;;EAED,WAASK,OAAT,CAAiBC,EAAjB,EAAqBC,OAArB,EAA8B;EAC7B,OAAI,CAACA,QAAQL,KAAR,CAAcM,KAAd,CAAL,EAA2B,MAAM,IAAIC,KAAJ,CAAU,yEAAV,CAAN;EAC3B,UAAOC,eAAezC,cAAf,EAA+BsC,OAA/B,EAAwC,YAAW;EACzD,WAAOD,GAAGK,KAAH,CAAS,IAAT,EAAeJ,QAAQK,MAAR,CAAe,CAACL,QAAQM,MAAR,CAAeb,OAAf,CAAD,CAAf,CAAf,CAAP;EACA,IAFM,CAAP;EAGA;;EAED,WAASU,cAAT,CAAwBI,GAAxB,EAA6BP,OAA7B,EAAsC1B,MAAtC,EAA8C;EAC7C,OAAID,QAAQkC,IAAIxC,MAAhB;EACAM,SAAMC,MAAN,GAAeA,MAAf;EACAD,SAAMI,OAAN,GAAgBuB,QAAQM,MAAR,CAAeE,QAAf,CAAhB;;EAEAC,sBAAmBF,GAAnB,EAAwBlC,MAAMI,OAA9B;EACAc,oBAAiBgB,GAAjB,EAAsB,IAAtB;;EAEA,UAAOA,GAAP;EACA;EACD,WAASE,kBAAT,CAA4B9C,MAA5B,EAAoCc,OAApC,EAA6C;EAC5C,QAAK,IAAIiC,IAAI,CAAb,EAAgBA,IAAIjC,QAAQZ,MAA5B,EAAoC6C,GAApC,EAAyC;EACxCjC,YAAQiC,CAAR,EAAW3C,MAAX,CAAkBS,IAAlB,CAAuBb,OAAOI,MAAP,CAAcI,EAArC,IAA2CR,MAA3C;EACA8C,uBAAmB9C,MAAnB,EAA2Bc,QAAQiC,CAAR,EAAW3C,MAAX,CAAkBU,OAA7C;EACA;EACD;EACD,WAASY,gBAAT,CAA0B1B,MAA1B,EAAkC;EACjC,QAAK,IAAI+C,IAAI,CAAb,EAAgBA,IAAI/C,OAAOI,MAAP,CAAcU,OAAd,CAAsBZ,MAA1C,EAAkD6C,GAAlD,EAAuD;EACtD,QAAIC,SAAShD,OAAOI,MAAP,CAAcU,OAAd,CAAsBiC,CAAtB,CAAb;EACA,WAAOC,OAAO5C,MAAP,CAAcS,IAAd,CAAmBb,OAAOI,MAAP,CAAcI,EAAjC,CAAP;EACA;EACD,QAAK,IAAIA,EAAT,IAAeR,OAAOI,MAAP,CAAcS,IAA7B,EAAmC;EAClC,QAAIoC,YAAYjD,OAAOI,MAAP,CAAcS,IAAd,CAAmBL,EAAnB,CAAhB;EACA,QAAI0C,QAAQD,UAAU7C,MAAV,CAAiBU,OAAjB,CAAyBqC,OAAzB,CAAiCnD,MAAjC,CAAZ;EACA,QAAIkD,QAAQ,CAAC,CAAb,EAAgBD,UAAU7C,MAAV,CAAiBU,OAAjB,CAAyBsC,MAAzB,CAAgCF,KAAhC,EAAuC,CAAvC;EAChB;EACDlD,UAAOI,MAAP,CAAcM,KAAd,GAAsB,CAAtB,CAViC;EAWjCV,UAAOI,MAAP,CAAcS,IAAd,GAAqB,EAArB;EACA;;EAED,WAASI,GAAT,CAAamB,EAAb,EAAiB;EAAC,UAAOD,QAAQ,UAASnC,MAAT,EAAiB;EAAC,WAAOoC,GAAGpC,QAAH,CAAP;EAAoB,IAA9C,EAAgD,CAAC,IAAD,CAAhD,CAAP;EAA+D;EACjF,WAASkB,EAAT,CAAYlB,MAAZ,EAAoB;EAAC,UAAOmC,QAAQ,UAASkB,EAAT,EAAaC,EAAb,EAAiB;EAAC,WAAOD,KAAKC,IAAL,CAAP;EAAkB,IAA5C,EAA8C,CAACtD,MAAD,EAAS,IAAT,CAA9C,CAAP;EAAqE;EAC1F,WAASmB,OAAT,GAAmB;EAAC,UAAO,KAAKf,MAAL,CAAYC,KAAnB;EAAyB;EAC7C,WAASe,MAAT,GAAkB;EAAC,UAAO,KAAKhB,MAAL,CAAYC,KAAZ,IAAqB,IAArB,IAA6B,OAAO,KAAKD,MAAL,CAAYC,KAAZ,CAAkBe,MAAzB,KAAoC,UAAjE,GAA8E,KAAKhB,MAAL,CAAYC,KAAZ,CAAkBe,MAAlB,EAA9E,GAA2G,KAAKhB,MAAL,CAAYC,KAA9H;EAAoI;;EAEvJ,WAASiC,KAAT,CAAetC,MAAf,EAAuB;EAAC,UAAOA,OAAOI,MAAd;EAAsB;EAC9C,WAAS6B,MAAT,CAAgBjC,MAAhB,EAAwB;EAAC,UAAOA,OAAOI,MAAP,CAAcM,KAAd,KAAwB,CAA/B;EAAiC;EAC1D,WAASoB,OAAT,CAAiB9B,MAAjB,EAAyB;EAAC,UAAOA,OAAOI,MAAP,CAAc0B,OAArB;EAA6B;EACvD,WAASe,QAAT,CAAkB7C,MAAlB,EAA0B;EAAC,UAAOA,OAAOI,MAAP,CAAcM,KAAd,KAAwB,CAA/B;EAAiC;;EAE5D,WAAS6C,KAAT,CAAelB,OAAf,EAAwB;EACvB,UAAOF,QAAQ,YAAW;EACzB,WAAOE,QAAQpB,GAAR,CAAY,UAASuC,CAAT,EAAY;EAAC,YAAOA,GAAP;EAAW,KAApC,CAAP;EACA,IAFM,EAEJnB,OAFI,CAAP;EAGA;;EAED,WAASoB,IAAT,CAAcC,OAAd,EAAuBC,IAAvB,EAA6B3D,MAA7B,EAAqC;EACpC,OAAI4D,YAAYzB,QAAQ,UAAUqB,CAAV,EAAa;EACpC,WAAOG,OAAOD,QAAQC,IAAR,EAAcH,EAAEpD,MAAF,CAASC,KAAvB,CAAd;EACA,IAFe,EAEb,CAACL,MAAD,CAFa,CAAhB;;EAIA,OAAI4D,UAAUxD,MAAV,CAAiBM,KAAjB,KAA2B,CAA/B,EAAkCkD,UAAUD,IAAV;;EAElC,UAAOC,SAAP;EACA;;EAED,WAASC,SAAT,CAAmBC,MAAnB,EAA2BH,IAA3B,EAAiC;EAChC,OAAItB,UAAUyB,OAAO7C,GAAP,CAAW,UAAS8C,KAAT,EAAgB;EACxC,QAAI/D,SAAS+D,MAAM,CAAN,CAAb;EACA,QAAI/D,OAAOI,MAAP,CAAcM,KAAd,KAAwB,CAA5B,EAA+BV,OAAOS,SAAP;EAC/B,WAAOT,MAAP;EACA,IAJa,CAAd;;EAMA,OAAI4D,YAAYzB,QAAQ,YAAW;EAClC,QAAIL,UAAU7B,UAAUA,UAAUC,MAAV,GAAmB,CAA7B,CAAd;;EAEAmC,YAAQ2B,OAAR,CAAgB,UAAShE,MAAT,EAAiBiE,GAAjB,EAAsB;EACrC,SAAInC,QAAQqB,OAAR,CAAgBnD,MAAhB,IAA0B,CAAC,CAA/B,EAAkC;EACjC2D,aAAOG,OAAOG,GAAP,EAAY,CAAZ,EAAeN,IAAf,EAAqB3D,OAAOI,MAAP,CAAcC,KAAnC,CAAP;EACA;EACD,KAJD;;EAMA,WAAOsD,IAAP;EACA,IAVe,EAUbtB,OAVa,CAAhB;;EAYA,UAAOuB,SAAP;EACA;;EAED7D,eAAa,iBAAb,IAAkCA,YAAlC;EACAA,eAAawD,KAAb,GAAqBA,KAArB;EACAxD,eAAaoC,OAAb,GAAuBA,OAAvB;EACApC,eAAa0D,IAAb,GAAoBA,IAApB;EACA1D,eAAa8D,SAAb,GAAyBA,SAAzB;EACA9D,eAAaD,IAAb,GAAoBA,IAApB;;EAEA,EAAmCoE,OAAO,SAAP,IAAoBnE,YAApB,CAAnC;EAIC,EA/JC,GAAD;;;ECCD,eAAiBoE,MAAjB;;;;ECEA,IAAMC,eAAe,KAArB;;AAEA,MAAaC,iBAAiB,SAAjBA,cAAiB,OAUxB;EAAA,gCATJC,aASI;EAAA,MATJA,aASI,sCATY,YAAM,EASlB;EAAA,8BARJC,WAQI;EAAA,MARJA,WAQI,oCARU,YAAM,EAQhB;EAAA,4BAPJC,SAOI;EAAA,MAPJA,SAOI,kCAPQ,IAOR;EAAA,6BANJC,UAMI;EAAA,MANJA,UAMI,mCANS;EAAA,WAAM,KAAN;EAAA,GAMT;EAAA,kCALJC,eAKI;EAAA,MALJA,eAKI,wCALc;EAAA,WAAO,EAAP;EAAA,GAKd;EAAA,0BAJJC,OAII;EAAA,MAJJA,OAII,gCAJM,YAAM,EAIZ;EAAA,4BAHJC,SAGI;EAAA,MAHJA,SAGI,kCAHQ,YAAM,EAGd;EAAA,2BAFJC,QAEI;EAAA,MAFJA,QAEI,iCAFO,YAAM,EAEb;EAAA,uBADJC,IACI;EAAA,MADJA,IACI,6BADG,IACH;;;EAEJ,MAAMC,SAAS,SAATA,MAAS,QAAS;EACtB,QAAMC,aAAa,SACjB,EADiB,EAEjBC,KAFiB,CAAnB;EAIA,QAAMC,eAAeR,gBAAgBM,UAAhB,EAA4BhF,QAA5B,EAAoC,EAAEjC,UAAF,EAApC,CAArB;EACA,aAAckH,MAAMvE,KAApB,EAA2BwE,YAA3B;EACAD,UAAME,QAAN,GAAiB,KAAjB;;EAEAF,UAAMvE,KAAN,CAAY0E,cAAZ,IAA8BH,MAAMvE,KAAN,CAAY0E,cAAZ,CAA2BnE,GAA3B,CAA+B;EAAA,aAC3DgE,MAAME,QAAN,IAAkBE,WAAW3F,SAAS4F,MAApB,CADyC;EAAA,KAA/B,CAA9B;EAGD,GAZD;;EAcA,MAAMC,WAAW,SAAXA,QAAW,QAAS;EACxBN,UAAME,QAAN,GAAiB,IAAjB;EACAR,YAAQM,KAAR,EAAe,EAAElH,UAAF,EAAf;EACD,GAHD;;EAKA,MAAMyH,SAAS,SAATA,MAAS,QAAS;EACtB,WAAO9F,SACL8E,aAAaC,WAAWQ,KAAX,CADR,EAELV,YAAYU,KAAZ,EAAmB,EAAEvF,kBAAF,EAAY0E,0BAAZ,EAA0BrG,UAA1B,EAAnB,CAFK,EAGL,CACEkH,MAAMQ,KAAN,CAAYC,MADd,EAEEpB,cAAcW,KAAd,EAAqB,EAAEvF,kBAAF,EAAY0E,0BAAZ,EAA0BrG,UAA1B,EAArB,CAFF,EAGEkH,MAAMQ,KAAN,CAAYE,KAHd,CAHK,CAAP;EASD,GAVD;;EAYA,SAAO;EACLb,UAAMA,OACF;EAAA,aAASA,KAAKG,KAAL,EAAY,EAAEO,cAAF,EAAU9F,kBAAV,EAAZ,CAAT;EAAA,KADE,GAEF;EAAA,aAAS8F,OAAOP,KAAP,CAAT;EAAA,KAHC;EAILF,kBAJK;EAKLQ,sBALK;EAMLK,cAAUhB,SANL;EAOLiB,cAAUhB;EAPL,GAAP;EASD,CApDM;;ECHP,IAAMT,iBAAe,KAArB;;AAEA,MAAa0B,gBAAgB,SAAhBA,aAAgB,OAQvB;EAAA,gCAPJxB,aAOI;EAAA,MAPJA,aAOI,sCAPY,YAAM,EAOlB;EAAA,8BANJC,WAMI;EAAA,MANJA,WAMI,oCANU,YAAM,EAMhB;EAAA,6BALJE,UAKI;EAAA,MALJA,UAKI,mCALS;EAAA,WAAM,KAAN;EAAA,GAKT;EAAA,4BAJJD,SAII;EAAA,MAJJA,SAII,kCAJQ,IAIR;EAAA,uBAHJM,IAGI;EAAA,MAHJA,IAGI,6BAHG,IAGH;EAAA,0BAFJH,OAEI;EAAA,MAFJA,OAEI,gCAFM,YAAM,EAEZ;EAAA,4BADJC,SACI;EAAA,MADJA,SACI,kCADQ,YAAM,EACd;;;EAEJ,MAAMY,SAAS,SAATA,MAAS;EAAA,WACb9F,SACE8E,aAAaC,WAAWQ,KAAX,CADf,EAEEV,YAAYU,KAAZ,EAAmB,EAAEvF,kBAAF,EAAY0E,4BAAZ,EAA0BrG,UAA1B,EAAnB,CAFF,EAGE,CACEkH,MAAMQ,KAAN,CAAYC,MADd,EAEEpB,cAAcW,KAAd,EAAqB,EAAEvF,kBAAF,EAAY0E,4BAAZ,EAA0BrG,UAA1B,EAArB,CAFF,EAGEkH,MAAMQ,KAAN,CAAYE,KAHd,CAHF,CADa;EAAA,GAAf;;EAWA,SAAO;EACLb,UAAMA,OACF;EAAA,aAASA,KAAKG,KAAL,EAAY,EAAEO,cAAF,EAAU9F,kBAAV,EAAZ,CAAT;EAAA,KADE,GAEF;EAAA,aAAS8F,OAAOP,KAAP,CAAT;EAAA,KAHC;EAILM,cAAU;EAAA,aAASZ,QAAQM,KAAR,EAAe,EAAElH,UAAF,EAAf,CAAT;EAAA,KAJL;EAKL6H,cAAUhB;EALL,GAAP;EAOD,CA5BM;;;;;;;;;;;;;;;"}