{"version":3,"file":"polythene-utilities.js","sources":["../src/easing.js","../src/scroll-to.js","../src/timer.js","../src/webfont-loader.js"],"sourcesContent":["/*\nhttps://gist.github.com/gre/1650294\nEasing Functions - inspired from http://gizma.com/easing/\nOnly considering the t value for the range [0, 1] => [0, 1]\n*/\n\nexport const easing = {\n  // no easing, no acceleration\n  linear: t => t,\n  // accelerating from zero velocity\n  easeInQuad: t => t * t,\n  // decelerating to zero velocity\n  easeOutQuad: t => t * (2 - t),\n  // acceleration until halfway, then deceleration\n  easeInOutQuad: t => t < .5 ? 2 * t * t : -1 + (4 - 2 * t) * t,\n  // accelerating from zero velocity\n  easeInCubic: t => t * t * t,\n  // decelerating to zero velocity\n  easeOutCubic: t => (--t) * t * t + 1,\n  // acceleration until halfway, then deceleration\n  easeInOutCubic: t => t < .5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1,\n  // accelerating from zero velocity\n  easeInQuart: t => t * t * t * t,\n  // decelerating to zero velocity\n  easeOutQuart: t => 1 - (--t) * t * t * t,\n  // acceleration until halfway, then deceleration\n  easeInOutQuart: t => t < .5 ? 8 * t * t * t * t : 1 - 8* (--t) * t * t * t,\n  // accelerating from zero velocity\n  easeInQuint: t => t * t * t * t * t,\n  // decelerating to zero velocity\n  easeOutQuint: t => 1 + (--t) * t * t * t * t,\n  // acceleration until halfway, then deceleration\n  easeInOutQuint: t => t < .5 ? 16 * t * t * t * t * t : 1 + 16 * (--t) * t * t * t * t\n};\n","/*\n Animated scroll to a position.\n Derived from https://github.com/madebysource/animated-scrollto\n Adapted to Mithril and rewritten to es6.\n*/\n\nimport { easing } from \"./easing\";\nimport { isServer } from \"polythene-core\";\n\nexport const scrollTo = opts => {\n  if (isServer) {\n    return;\n  }\n  const element = opts.element;\n  const which = (opts.direction === \"horizontal\") ? \"scrollLeft\" : \"scrollTop\";\n  const to = opts.to;\n  const duration = opts.duration * 1000;\n  const easingFn = opts.easing || easing.easeInOutCubic;\n  const start = element[which];\n  const change = to - start;\n  const animationStart = new Date().getTime();\n  let animating = true;\n  return new Promise(resolve => {\n    const animateScroll = () => {\n      if (!animating) {\n        return;\n      }\n      requestAnimFrame(animateScroll);\n      const now = new Date().getTime();\n      const percentage = ((now - animationStart) / duration);\n      const val = start + change * easingFn(percentage);\n      element[which] = val;\n      if (percentage >= 1) {\n        element[which] = to;\n        animating = false;\n        resolve();\n      }\n    };\n    requestAnimFrame(animateScroll);\n  });\n};\n\nconst requestAnimFrame = isServer\n  ? () => {}\n  : (() =>\n    window.requestAnimationFrame || window.webkitRequestAnimationFrame || window[\"mozRequestAnimationFrame\"] || (callback =>\n      window.setTimeout(callback, 1000 / 60)\n    )\n  )();\n","// @ts-check\n\nimport { isClient } from \"polythene-core\";\n\nexport const Timer = function() {\n\n  /** @type {number} */\n  let timerId;\n\n  /** @type {number} */\n  let startTime;\n\n  /** @type {number} */\n  let remaining;\n\n  /** @type {() => any} */\n  let cb;\n\n  const stop = () => {\n    if (isClient) {\n      window.clearTimeout(timerId);\n    }\n  };\n\n  const pause = () => (\n    stop(),\n    remaining -= new Date().getTime() - startTime\n  );\n\n  const startTimer = () => {\n    if (isClient) {\n      stop();\n      startTime = new Date().getTime();\n      timerId = window.setTimeout(cb, remaining);\n    }\n  };\n\n  const start = (callback, duration) => (\n    cb = callback,\n    remaining = duration * 1000,\n    startTimer()\n  );\n\n  const resume = () =>\n    startTimer();\n\n  return {\n    start,\n    pause,\n    resume,\n    stop\n  };\n};\n","import { isServer, emit } from \"polythene-core\";\n\nexport const addWebFont = (vendor, config) => {\n  if (isServer) return;\n  if (!window[\"WebFontConfig\"]) {\n    /**\n     * @param {object} params\n     * @param {string} [params.name]\n     * @param {string} [params.familyName]\n     * @param {any} [params.fvd]\n     */\n    const emitEvent = ({ name, familyName, fvd }) => \n      emit(\"webfontloader\", { name, familyName, fvd, vendor, config });\n    window[\"WebFontConfig\"] = {\n      loading:      ()                => emitEvent({ name: \"loading\" }),\n      active:       ()                => emitEvent({ name: \"active\" }),\n      inactive:     ()                => emitEvent({ name: \"inactive\" }),\n      fontloading:  (familyName, fvd) => emitEvent({ name: \"fontloading\", familyName, fvd }),\n      fontactive:   (familyName, fvd) => emitEvent({ name: \"fontactive\", familyName, fvd }),\n      fontinactive: (familyName, fvd) => emitEvent({ name: \"fontinactive\", familyName, fvd }),\n    };\n    (function() {\n      const wf = document.createElement(\"script\");\n      wf.src = (document.location.protocol === \"https:\" ? \"https\" : \"http\") + \"://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js\";\n      wf.type = \"text/javascript\";\n      wf.async = true;\n      const s = document.getElementsByTagName(\"script\")[0];\n      if (s && s.parentNode) {\n        s.parentNode.insertBefore(wf, s);\n      }\n    })();\n  }\n  const vendorCfg = window[\"WebFontConfig\"][vendor] || {};\n  if (config) {\n    Object.assign(vendorCfg, config);\n  }\n  window[\"WebFontConfig\"][vendor] = vendorCfg;\n};\n"],"names":["easing","linear","t","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","requestAnimFrame","isServer","window","requestAnimationFrame","webkitRequestAnimationFrame","callback","setTimeout","timerId","startTime","remaining","cb","stop","isClient","clearTimeout","startTimer","Date","getTime","start","duration","pause","resume","vendor","config","emitEvent","name","familyName","fvd","emit","loading","active","inactive","fontloading","fontactive","fontinactive","wf","document","createElement","src","location","protocol","type","async","s","getElementsByTagName","parentNode","insertBefore","vendorCfg","opts","element","which","direction","to","easingFn","change","animationStart","animating","Promise","resolve","animateScroll","percentage","val"],"mappings":"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"}