{"version":3,"file":"polythene-css-menu.js","sources":["../../polythene-css-classes/menu.js","../src/color.js","../src/vars.js","../src/layout.js","../src/index.js"],"sourcesContent":["import listTileClasses from \"./list-tile\";\n\nexport default {\n  component:   \"pe-menu\",\n\n  // elements\n  panel:       \"pe-menu__panel\",\n  content:     \"pe-menu__content\",\n  placeholder: \"pe-menu__placeholder\",\n  backdrop:    \"pe-menu__backdrop\",\n\n  // states\n  floating:     \"pe-menu--floating\",\n  origin:       \"pe-menu--origin\",\n  permanent:    \"pe-menu--permanent\",\n  showBackdrop: \"pe-menu--backdrop\",\n  visible:      \"pe-menu--visible\",\n  width_auto:   \"pe-menu--width-auto\",\n  width_n:      \"pe-menu--width-\",\n  isTopMenu:    \"pe-menu--top-menu\",\n\n  // lookup\n  listTile:         listTileClasses.component,\n  selectedListTile: listTileClasses.selected,\n};","// @ts-check\n\nimport { sel, createColor } from \"polythene-core-css\";\n\nconst generalFns = ({\n  general_styles: selector => [], // eslint-disable-line no-unused-vars\n});\n\nconst tintFns = tint => ({\n  [\"color_\" + tint + \"_background\"]: (selector, vars) => [\n    sel(selector, {\n      \" .pe-menu__panel\": {\n        \"background-color\": vars[\"color_\" + tint + \"_background\"]\n      }\n    })\n  ],\n  [\"color_\" + tint + \"_backdrop_background\"]: (selector, vars) => [\n    sel(selector, {\n      \" .pe-menu__backdrop\": {\n        \"background-color\": vars[\"color_\" + tint + \"_backdrop_background\"]\n      }\n    })\n  ]\n});\n\nconst lightTintFns = Object.assign({}, generalFns, tintFns(\"light\"));\nconst darkTintFns = Object.assign({}, generalFns, tintFns(\"dark\"));\n\nexport default createColor({\n  varFns: { lightTintFns, darkTintFns }\n});\n","// @ts-check\n\n/**\n * @typedef {import(\"../index\").MenuVars} MenuVars\n */\n\nimport { rgba } from \"polythene-core-css\";\nimport { vars } from \"polythene-theme\";\nimport { sharedVars as shadowVars } from \"polythene-css-shadow\";\n\nexport const behaviorVars = {\n  top_menu:                       false, // set to true to position the menu at the top of the screen, full width\n};\n\nconst themeVars = {\n  backdrop:                       undefined, // (Boolean) - if not set, backdrop existence is set by component option\n  z:                              vars.z_menu, // z-depth of the menu (not the shadow depth)\n  \n  ...behaviorVars,\n  ...shadowVars\n};\n\n/**\n * @type {MenuVars} menuVars\n */\nconst menuVars = {\n  /**\n   * Generate general styles, not defined by variables\n   */\n  general_styles:                   true,\n        \n  animation_delay:                  \"0s\",\n  animation_duration:               \".180s\",\n  animation_hide_css:               \"opacity: 0;\",\n  animation_hide_origin_effect_css: \"transform: scale(0.75);\", // set to \"transform: scale(1)\" to reset scaling\n  animation_show_css:               \"opacity: 1;\",\n  animation_show_origin_effect_css: \"transform: scale(1);\",\n  animation_timing_function:        \"ease-in-out\",\n  border_radius:                    vars.unit_block_border_radius,\n  height:                           undefined, // (height value with unit) - if not set, height is set by component option\n  min_width:                        1.5,\n  width_factor:                     vars.grid_unit_menu,\n  widths:                           [1, 1.5, 2, 3, 4, 5, 6, 7],\n\n  // color vars\n\n  color_light_background:           rgba(vars.color_light_background),\n  color_dark_background:            rgba(vars.color_dark_background),\n\n  color_light_backdrop_background:  \"rgba(0, 0, 0, .1)\",\n  color_dark_backdrop_background:   \"rgba(0, 0, 0, .5)\",\n\n  // text colors are set by content, usually list tiles\n  \n  ...themeVars\n};\n\nexport default menuVars;\n","// @ts-check\n\nimport { vars as themeVars } from \"polythene-theme\";\nimport { sel, selectorRTL, createLayout, createMarker } from \"polythene-core-css\";\nimport { sharedVarFns as shadowVarFns } from \"polythene-css-shadow\";\nimport { behaviorVars } from \"./vars\";\n\n/**\n * \n * @param {boolean} isRTL \n */\nconst alignSide = isRTL => () => ({\n  textAlign: isRTL ? \"right\" : \"left\"\n});\n\nconst alignLeft = alignSide(false);\nconst alignRight = alignSide(true);\n\nconst unifyWidth = (vars, width) =>\n  width < vars.min_width ? vars.min_width : width;\n\nconst widthClass = width => {\n  const widthStr = width.toString().replace(\".\", \"-\");\n  return \"pe-menu--width-\" + widthStr;\n};\n\n/**\n * \n * @param {object} params\n * @param {object} params.vars\n * @param {number} params.width\n * @param {string} [params.value]\n */\nconst widthStyle = ({ vars, width, value }) => {\n  const s = unifyWidth(vars, width);\n  return {\n    [\".\" + widthClass(s)]: {\n      \" .pe-menu__panel\": {\n        width: value || vars.width_factor * s + \"px\",\n        // We can't set maxWidth because we don't know the width of the container\n      }\n    }\n  };\n};\n\nconst widths_min_width_width_factor = (selector, vars) =>\n  sel(selector, [\n    vars.widths.map(width => widthStyle({ vars, width })),\n    {\n      \" .pe-menu__panel\": {\n        minWidth: themeVars.grid_unit_menu * vars.min_width + \"px\",\n      }\n    }\n  ]);\n\nconst backdrop = (selector, vars) => // eslint-disable-line no-unused-vars\n  sel(selector, {\n    \" .pe-menu__backdrop\": {\n      display: \"block\"\n    }\n  });\n\nconst top_menu = (selector, vars) =>\n  sel(selector, [\n    vars.widths.map(width => widthStyle({ vars, width, value: \"100vw\" })),\n    createMarker(vars, behaviorVars),\n    {\n      \" .pe-menu__panel\": {\n        position: \"fixed\",\n        width: \"100vw\",\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: \"auto\",\n        borderTopLeftRadius: 0,\n        borderTopRightRadius: 0, \n      }\n    }\n  ]);\n\nconst z = (selector, vars) =>\n  sel(selector, {\n    \".pe-menu--floating\": {\n      \" .pe-menu__panel, .pe-menu__backdrop\": {\n        zIndex: vars.z,\n      }\n    }\n  });\n\nconst varFns = {\n  general_styles: (selector, vars) => [\n    sel(selector, [\n      alignLeft(),\n      {\n        position: \"static\",\n\n        \".pe-menu--width-auto\": {\n          width: \"auto\"\n        },\n\n        \".pe-menu--permanent\": {\n          \" .pe-menu__panel\": {\n            opacity: 1,\n            position: \"relative\",\n          }\n        },\n\n        \".pe-menu--floating\": {\n          \" .pe-menu__panel\": {\n            transitionProperty: \"opacity, transform\",\n          }\n        },\n\n        \" .pe-menu__panel\": {\n          transitionProperty: \"all\",\n          opacity: 0,\n          position: \"absolute\",\n        },\n\n        \" .pe-menu__backdrop\": {\n          display: \"none\",\n          transitionProperty: \"all\",\n          position: \"fixed\",\n          top: 0,\n          right: 0,\n          bottom: 0,\n          left: 0,\n          opacity: 0,\n        },\n\n        \".pe-menu--backdrop\": backdrop(selector),\n\n        \".pe-menu--visible .pe-menu__backdrop\": {\n          opacity: 1\n        },\n\n        \".pe-menu--top-menu\": top_menu(selector, vars),\n\n        \" .pe-menu__content\": {\n          overflowX: \"auto\",\n          overflowY: \"auto\",\n          width: \"100%\",\n          height: \"100%\",\n        },\n\n        \".pe-menu--full-height\": {\n          height: \"100%\",\n\n          \" .pe-menu__panel\": {\n            height: \"100%\"\n          }\n        }\n      }\n    ]),\n    {\n      [selectorRTL(selector)]: alignRight()\n    }\n  ],\n  animation_delay: (selector, vars) => [\n    sel(selector, {\n      \" .pe-menu__panel, .pe-menu__backdrop\": {\n        transitionDelay: vars.animation_delay,\n      }\n    })\n  ],\n  animation_duration: (selector, vars) => [\n    sel(selector, {\n      \" .pe-menu__panel, .pe-menu__backdrop\": {\n        transitionDuration: vars.animation_duration,\n      }\n    })\n  ],\n  animation_timing_function: (selector, vars) => [\n    sel(selector, {\n      \" .pe-menu__panel, .pe-menu__backdrop\": {\n        transitionTimingFunction: vars.animation_timing_function,\n      }\n    })\n  ],\n  animation_show_css: (selector, vars) => [\n    sel(selector, {\n      \".pe-menu--visible\": {\n        \" .pe-menu__panel\": vars.animation_show_css\n      }\n    })\n  ],\n  animation_hide_css: (selector, vars) => [\n    sel(selector, {\n      \" .pe-menu__panel\": vars.animation_hide_css,\n    })\n  ],\n  animation_show_origin_effect_css: (selector, vars) => [\n    sel(selector, {\n      \".pe-menu--origin.pe-menu--visible\": {\n        \" .pe-menu__panel\": vars.animation_show_origin_effect_css\n      }\n    })\n  ],\n  animation_hide_origin_effect_css: (selector, vars) => [\n    sel(selector, {\n      \".pe-menu--origin:not(.pe-menu--visible)\": {\n        \" .pe-menu__panel\": vars.animation_hide_origin_effect_css\n      }\n    })\n  ],\n  height: (selector, vars) => [\n    vars.height !== undefined && sel(selector, {\n      \" .pe-menu__panel\": {\n        height: vars.height\n      }\n    })\n  ],\n  widths: (selector, vars) => [\n    widths_min_width_width_factor(selector, vars)\n  ],\n  min_width: (selector, vars) => [\n    widths_min_width_width_factor(selector, vars)\n  ],\n  width_factor: (selector, vars) => [\n    widths_min_width_width_factor(selector, vars)\n  ],\n  border_radius: (selector, vars) => [\n    sel(selector, {\n      \" .pe-menu__panel\": {\n        borderRadius: vars.border_radius + \"px\"\n      }\n    })\n  ],\n  // Theme vars\n  backdrop: (selector, vars) => [\n    vars.backdrop && backdrop(selector, vars)\n  ],\n  top_menu: (selector, vars) => [\n    vars.top_menu && top_menu(selector, vars)\n  ],\n  z: (selector, vars) => [\n    vars.z && z(selector, vars)\n  ],\n  // shadow_depth:\n  ...shadowVarFns\n};\n\nexport default createLayout({ varFns });\n","// @ts-check\n\nimport classes from \"polythene-css-classes/menu\";\nimport color from \"./color\";\nimport layout from \"./layout\";\nimport vars from \"./vars\";\nimport { styler } from \"polythene-core-css\";\n\nconst fns = [layout, color];\nconst selector = `.${classes.component}`;\n\nconst addStyle = styler.createAddStyle(selector, fns, vars);\n\nconst getStyle = styler.createGetStyle(selector, fns, vars);\n\nconst addGeneralStyleToHead = () => \n  styler.addStyle({\n    selectors: [selector],\n    fns,\n    vars\n  });\n\nexport {\n  addGeneralStyleToHead,\n  addStyle,\n  getStyle,\n  color,\n  layout,\n  vars,\n};\n"],"names":["generalFns","general_styles","selector","tintFns","tint","vars","sel","lightTintFns","_extends","darkTintFns","createColor","varFns","behaviorVars","top_menu","themeVars","backdrop","undefined","z","z_menu","shadowVars","menuVars","animation_delay","animation_duration","animation_hide_css","animation_hide_origin_effect_css","animation_show_css","animation_show_origin_effect_css","animation_timing_function","border_radius","unit_block_border_radius","height","min_width","width_factor","grid_unit_menu","widths","color_light_background","rgba","color_dark_background","color_light_backdrop_background","color_dark_backdrop_background","alignSide","isRTL","textAlign","alignLeft","alignRight","widthStyle","width","value","s","unifyWidth","toString","replace","widthClass","widths_min_width_width_factor","map","minWidth","display","createMarker","position","top","left","right","bottom","borderTopLeftRadius","borderTopRightRadius","zIndex","opacity","transitionProperty","overflowX","overflowY","selectorRTL","transitionDelay","transitionDuration","transitionTimingFunction","borderRadius","shadowVarFns","createLayout","fns","layout","color","classes","addStyle","styler","createAddStyle","getStyle","createGetStyle","selectors"],"mappings":"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"}