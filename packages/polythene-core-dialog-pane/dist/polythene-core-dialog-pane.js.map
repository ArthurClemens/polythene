{"version":3,"file":"polythene-core-dialog-pane.js","sources":["../../polythene-css-classes/dialog-pane.js","../../polythene-css-classes/button.js","../src/index.js"],"sourcesContent":["\nexport default {\n  component:         \"pe-dialog-pane\",\n\n  // elements\n  actions:           \"pe-dialog-pane__actions\",\n  body:              \"pe-dialog-pane__body\",\n  content:           \"pe-dialog-pane__content\",\n  footer:            \"pe-dialog-pane__footer\",\n  header:            \"pe-dialog-pane__header\",\n  title:             \"pe-dialog-pane__title\",\n\n  // states\n  withHeader:        \"pe-dialog-pane--header\",\n  withFooter:        \"pe-dialog-pane--footer\",\n  headerWithTitle:   \"pe-dialog-pane__header--title\",\n  footerWithButtons: \"pe-dialog-pane__footer--buttons\",\n  footerHigh:        \"pe-dialog-pane__footer--high\",\n  borderBottom:      \"pe-dialog-pane--border-bottom\",\n  borderTop:         \"pe-dialog-pane--border-top\",\n  fullBleed:         \"pe-dialog-pane--body-full-bleed\",\n};\n","\nexport default {\n  component:        \"pe-text-button\",\n  super:            \"pe-button\",\n  row:              \"pe-button-row\",\n      \n  // elements      \n  content:          \"pe-button__content\",\n  label:            \"pe-button__label\",\n  textLabel:        \"pe-button__text-label\",\n  wash:             \"pe-button__wash\",\n  washColor:        \"pe-button__wash-color\",\n  dropdown:         \"pe-button__dropdown\",\n      \n  // states      \n  border:           \"pe-button--border\",\n  contained:        \"pe-button--contained\",\n  disabled:         \"pe-button--disabled\",\n  dropdownClosed:   \"pe-button--dropdown-closed\",\n  dropdownOpen:     \"pe-button--dropdown-open\",\n  extraWide:        \"pe-button--extra-wide\",\n  hasDropdown:      \"pe-button--dropdown\",\n  highLabel:        \"pe-button--high-label\",\n  inactive:         \"pe-button--inactive\",\n  raised:           \"pe-button--raised\",\n  selected:         \"pe-button--selected\",\n  separatorAtStart: \"pe-button--separator-start\",\n  hasHover:         \"pe-button--has-hover\",\n};\n","import {\n  filterSupportedAttributes,\n  unpackAttrs,\n  subscribe,\n  unsubscribe,\n} from \"polythene-core\";\nimport classes from \"polythene-css-classes/dialog-pane\";\nimport buttonClasses from \"polythene-css-classes/button\";\n\nconst SCROLL_WATCH_END_TIMER = 50;\n\nexport const _DialogPane = ({\n  h,\n  a,\n  useState,\n  useEffect,\n  useRef,\n  getRef,\n  ...unpackedProps\n}) => {\n  const props = unpackAttrs(unpackedProps);\n\n  const [domElement, setDomElement] = useState();\n  const [isScrolling, setIsScrolling] = useState(false);\n  const [hasTopOverflow, setHasTopOverflow] = useState(false);\n  const [hasBottomOverflow, setHasBottomOverflow] = useState(false);\n  const headerElRef = useRef();\n  const footerElRef = useRef();\n  const scrollElRef = useRef();\n  const scrollWatchIdRef = useRef();\n\n  const updateScrollOverflowState = () => {\n    const scroller = scrollElRef.current;\n    if (!scroller) {\n      return;\n    }\n    setHasTopOverflow(scroller.scrollTop > 0);\n    setHasBottomOverflow(\n      scroller.scrollHeight -\n        (scroller.scrollTop + scroller.getBoundingClientRect().height) >\n        0\n    );\n  };\n\n  useEffect(() => {\n    if (!domElement) {\n      return;\n    }\n    headerElRef.current = domElement.querySelector(`.${classes.header}`);\n    footerElRef.current = domElement.querySelector(`.${classes.footer}`);\n    scrollElRef.current = domElement.querySelector(`.${classes.body}`);\n  }, [domElement]);\n\n  useEffect(() => {\n    if (!scrollElRef.current) {\n      return;\n    }\n    const update = () => {\n      updateScrollOverflowState();\n    };\n    subscribe(\"resize\", update);\n\n    return () => {\n      unsubscribe(\"resize\", update);\n    };\n  }, [scrollElRef.current]);\n\n  useEffect(() => {\n    updateScrollOverflowState();\n  }, [scrollElRef.current, isScrolling]);\n\n  const withHeader = props.header !== undefined || props.title !== undefined;\n  const withFooter =\n    props.footer !== undefined || props.footerButtons !== undefined;\n  const borders = props.borders || \"overflow\";\n  const showTopBorder =\n    borders === \"always\" ||\n    (withHeader && borders === \"overflow\" && hasTopOverflow);\n  const showBottomBorder =\n    borders === \"always\" ||\n    (withFooter && borders === \"overflow\" && hasBottomOverflow);\n\n  const componentProps = Object.assign(\n    {},\n    filterSupportedAttributes(props, { remove: [\"style\"] }), // style set in content, and set by show/hide transition\n    props.testId && { \"data-test-id\": props.testId },\n    getRef(\n      (dom) =>\n        dom && !domElement && (setDomElement(dom), props.ref && props.ref(dom))\n    ),\n    {\n      className: [\n        classes.component,\n        props.fullBleed ? classes.fullBleed : null,\n        showTopBorder ? classes.borderTop : null,\n        showBottomBorder ? classes.borderBottom : null,\n        withHeader ? classes.withHeader : null,\n        withFooter ? classes.withFooter : null,\n        props.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        props.tone === \"light\" ? \"pe-light-tone\" : null,\n        props.className || props[a.class],\n      ].join(\" \"),\n    },\n    props.formOptions\n  );\n\n  const componentContent = h(\n    \"div\",\n    {\n      className: [\n        classes.content,\n        props.menu ? classes.menuContent : null,\n      ].join(\" \"),\n      style: props.style,\n      role: \"dialog\",\n    },\n    [\n      props.header\n        ? props.header\n        : props.title\n        ? h(\n            \"div\",\n            {\n              className: [classes.header, classes.headerWithTitle].join(\" \"),\n            },\n            h(\"div\", { className: classes.title }, props.title)\n          )\n        : null,\n      h(\n        \"div\",\n        {\n          className: classes.body,\n          [a.onscroll]: () => {\n            setIsScrolling(true);\n            clearTimeout(scrollWatchIdRef.current);\n            scrollWatchIdRef.current = setTimeout(() => {\n              setIsScrolling(false);\n            }, SCROLL_WATCH_END_TIMER);\n          },\n        },\n        props.content || props.body || props.menu\n      ),\n      props.footer\n        ? h(\n            \"div\",\n            {\n              className: classes.footer,\n            },\n            props.footer\n          )\n        : props.footerButtons\n        ? h(\n            \"div\",\n            {\n              className: [\n                classes.footer,\n                classes.footerWithButtons,\n                buttonClasses.row,\n              ].join(\" \"),\n            },\n            h(\"div\", { className: classes.actions }, props.footerButtons)\n          )\n        : null,\n    ]\n  );\n  const content = [props.before, componentContent, props.after];\n  return h(props.element || \"form\", componentProps, content);\n};\n"],"names":["component","actions","body","content","footer","header","title","withHeader","withFooter","headerWithTitle","footerWithButtons","footerHigh","borderBottom","borderTop","fullBleed","row","label","textLabel","wash","washColor","dropdown","border","contained","disabled","dropdownClosed","dropdownOpen","extraWide","hasDropdown","highLabel","inactive","raised","selected","separatorAtStart","hasHover","h","a","useState","useEffect","useRef","getRef","unpackedProps","props","unpackAttrs","domElement","setDomElement","isScrolling","setIsScrolling","hasTopOverflow","setHasTopOverflow","hasBottomOverflow","setHasBottomOverflow","headerElRef","footerElRef","scrollElRef","scrollWatchIdRef","updateScrollOverflowState","scroller","current","scrollTop","scrollHeight","getBoundingClientRect","height","querySelector","classes","update","subscribe","unsubscribe","undefined","footerButtons","borders","showTopBorder","showBottomBorder","componentProps","_extends","filterSupportedAttributes","remove","testId","dom","ref","className","tone","join","formOptions","componentContent","menu","menuContent","style","role","onscroll","clearTimeout","setTimeout","buttonClasses","before","after","element"],"mappings":"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"}