{"version":3,"file":"polythene-core-dialog-pane.js","sources":["../../polythene-css-classes/dialog-pane.js","../../polythene-css-classes/button.js","../src/index.js"],"sourcesContent":["\nexport default {\n  component:         \"pe-dialog-pane\",\n\n  // elements\n  actions:           \"pe-dialog-pane__actions\",\n  body:              \"pe-dialog-pane__body\",\n  content:           \"pe-dialog-pane__content\",\n  footer:            \"pe-dialog-pane__footer\",\n  header:            \"pe-dialog-pane__header\",\n  title:             \"pe-dialog-pane__title\",\n\n  // states\n  withHeader:        \"pe-dialog-pane--header\",\n  withFooter:        \"pe-dialog-pane--footer\",\n  headerWithTitle:   \"pe-dialog-pane__header--title\",\n  footerWithButtons: \"pe-dialog-pane__footer--buttons\",\n  footerHigh:        \"pe-dialog-pane__footer--high\",\n  borderBottom:      \"pe-dialog-pane--border-bottom\",\n  borderTop:         \"pe-dialog-pane--border-top\",\n  fullBleed:         \"pe-dialog-pane--body-full-bleed\",\n};\n","\nexport default {\n  component:        \"pe-text-button\",\n  super:            \"pe-button\",\n  row:              \"pe-button-row\",\n      \n  // elements      \n  content:          \"pe-button__content\",\n  label:            \"pe-button__label\",\n  textLabel:        \"pe-button__text-label\",\n  wash:             \"pe-button__wash\",\n  dropdown:         \"pe-button__dropdown\",\n      \n  // states      \n  border:           \"pe-button--border\",\n  contained:        \"pe-button--contained\",\n  disabled:         \"pe-button--disabled\",\n  dropdownClosed:   \"pe-button--dropdown-closed\",\n  dropdownOpen:     \"pe-button--dropdown-open\",\n  extraWide:        \"pe-button--extra-wide\",\n  hasDropdown:      \"pe-button--dropdown\",\n  focus:            \"pe-button--focus\",\n  highLabel:        \"pe-button--high-label\",\n  inactive:         \"pe-button--inactive\",\n  raised:           \"pe-button--raised\",\n  selected:         \"pe-button--selected\",\n  separatorAtStart: \"pe-button--separator-start\",\n};\n","import { filterSupportedAttributes, unpackAttrs, subscribe, unsubscribe } from \"polythene-core\";\nimport classes from \"polythene-css-classes/dialog-pane\";\nimport buttonClasses from \"polythene-css-classes/button\";\n\nconst SCROLL_WATCH_END_TIMER = 50;\n\nexport const _DialogPane = ({ h, a, useState, useEffect, useRef, getRef, ...unpackedProps }) => {\n  const props = unpackAttrs(unpackedProps);\n\n  const [domElement, setDomElement] = useState();\n  const [isScrolling, setIsScrolling] = useState(false);\n  const [hasTopOverflow, setHasTopOverflow] = useState(false);\n  const [hasBottomOverflow, setHasBottomOverflow] = useState(false);\n  const headerElRef = useRef();\n  const footerElRef = useRef();\n  const scrollElRef = useRef();\n  const scrollWatchIdRef = useRef();\n\n  const updateScrollOverflowState = () => {\n    const scroller = scrollElRef.current;\n    if (!scroller) {\n      return;\n    }\n    setHasTopOverflow(scroller.scrollTop > 0);\n    setHasBottomOverflow(scroller.scrollHeight - (scroller.scrollTop + scroller.getBoundingClientRect().height) > 0);\n  };\n\n  useEffect(\n    () => {\n      if (!domElement) {\n        return;\n      }\n      headerElRef.current = domElement.querySelector(`.${classes.header}`);\n      footerElRef.current = domElement.querySelector(`.${classes.footer}`);\n      scrollElRef.current = domElement.querySelector(`.${classes.body}`);\n    },\n    [domElement]\n  );\n\n  useEffect(\n    () => {\n      if (!scrollElRef.current) {\n        return;\n      }\n      const update = () => {\n        updateScrollOverflowState();\n      };\n      subscribe(\"resize\", update);\n\n      return () => {\n        unsubscribe(\"resize\", update);\n      };\n    },\n    [scrollElRef.current]\n  );\n\n  useEffect(\n    () => {\n      updateScrollOverflowState();\n    },\n    [scrollElRef.current, isScrolling]\n  );\n  \n  const withHeader = props.header !== undefined || props.title !== undefined;\n  const withFooter = props.footer !== undefined || props.footerButtons !== undefined;\n  const borders = props.borders || \"overflow\";\n  const showTopBorder = borders === \"always\" || (withHeader && borders === \"overflow\" && hasTopOverflow);\n  const showBottomBorder = borders === \"always\" || (withFooter && borders === \"overflow\" && hasBottomOverflow);\n\n  const componentProps = Object.assign(\n    {}, \n    filterSupportedAttributes(props, { remove: [\"style\"] }), // style set in content, and set by show/hide transition\n    props.testId && { \"data-test-id\": props.testId },\n    getRef(dom => dom && !domElement && (\n      setDomElement(dom),\n      props.ref && props.ref(dom)\n    )),\n    {\n      className: [\n        classes.component,\n        props.fullBleed ? classes.fullBleed : null,\n        showTopBorder ? classes.borderTop : null,\n        showBottomBorder ? classes.borderBottom : null,\n        withHeader ? classes.withHeader : null,\n        withFooter ? classes.withFooter : null,\n        props.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        props.tone === \"light\" ? \"pe-light-tone\" : null,\n        props.className || props[a.class],\n      ].join(\" \"),\n    },\n    props.formOptions\n  );\n\n  const contents = h(\"div\",\n    {\n      className: [\n        classes.content,\n        props.menu ? classes.menuContent : null\n      ].join(\" \"),\n      style: props.style\n    },\n    [\n      props.header\n        ? props.header\n        : props.title\n          ? h(\"div\",\n            {\n              className: [\n                classes.header,\n                classes.headerWithTitle\n              ].join(\" \"),\n              key: \"title\"\n            },\n            h(\"div\",\n              { className: classes.title },\n              props.title\n            )\n          )\n          : null,\n      h(\"div\",\n        {\n          className: classes.body,\n          key: \"body\",\n          [a.onscroll]: () => {\n            setIsScrolling(true);\n            clearTimeout(scrollWatchIdRef.current);\n            scrollWatchIdRef.current = setTimeout(() => {\n              setIsScrolling(false);\n            }, SCROLL_WATCH_END_TIMER);\n          }\n        },\n        props.content || props.body || props.menu\n      ),\n      props.footer\n        ? h(\"div\",\n          {\n            className: classes.footer,\n            key: \"footer\"\n          },\n          props.footer\n        )\n        : props.footerButtons\n          ? h(\"div\",\n            {\n              className: [\n                classes.footer,\n                classes.footerWithButtons,\n                buttonClasses.row\n              ].join(\" \"),\n              key: \"footer\"\n            },\n            h(\"div\",\n              { className: classes.actions },\n              props.footerButtons\n            )\n          )\n          : null\n    ]\n  );\n  const content = [\n    props.before,\n    contents,\n    props.after\n  ];\n  return h(props.element || \"form\", componentProps, content);\n};\n"],"names":["component","actions","body","content","footer","header","title","withHeader","withFooter","headerWithTitle","footerWithButtons","footerHigh","borderBottom","borderTop","fullBleed","row","label","textLabel","wash","dropdown","border","contained","disabled","dropdownClosed","dropdownOpen","extraWide","hasDropdown","focus","highLabel","inactive","raised","selected","separatorAtStart","h","a","useState","useEffect","useRef","getRef","unpackedProps","props","unpackAttrs","domElement","setDomElement","isScrolling","setIsScrolling","hasTopOverflow","setHasTopOverflow","hasBottomOverflow","setHasBottomOverflow","headerElRef","footerElRef","scrollElRef","scrollWatchIdRef","updateScrollOverflowState","scroller","current","scrollTop","scrollHeight","getBoundingClientRect","height","querySelector","classes","update","subscribe","unsubscribe","undefined","footerButtons","borders","showTopBorder","showBottomBorder","componentProps","_extends","filterSupportedAttributes","remove","testId","dom","ref","className","tone","join","formOptions","contents","menu","menuContent","style","key","onscroll","clearTimeout","setTimeout","buttonClasses","before","after","element"],"mappings":"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"}