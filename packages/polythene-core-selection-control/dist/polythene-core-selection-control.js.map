{"version":3,"file":"polythene-core-selection-control.js","sources":["../../polythene-css-classes/selection-control.js","../src/selection-control.js","../src/view-control.js"],"sourcesContent":["\nexport default {\n  component: \"pe-control\",\n\n  // elements\n  formLabel: \"pe-control__form-label\",\n  input:     \"pe-control__input\",\n  label:     \"pe-control__label\",\n\n  // states\n  disabled:  \"pe-control--disabled\",\n  inactive:  \"pe-control--inactive\",\n  large:     \"pe-control--large\",\n  medium:    \"pe-control--medium\",\n  off:       \"pe-control--off\",\n  on:        \"pe-control--on\",\n  regular:   \"pe-control--regular\",\n  small:     \"pe-control--small\",\n\n  // control view elements\n  box:       \"pe-control__box\",\n  button:    \"pe-control__button\",\n\n  // control view states\n  buttonOff: \"pe-control__button--off\",\n  buttonOn:  \"pe-control__button--on\",\n};\n","import { filterSupportedAttributes, classForSize } from \"polythene-core\";\nimport classes from \"polythene-css-classes/selection-control\";\n\nexport const getElement = vnode =>\n  vnode.attrs.element || \"div\";\n\nconst currentState = (attrs, state) => {\n  const checked = attrs.checked !== undefined\n    ? attrs.checked\n    : state.checked();\n  const selectable = attrs.selectable !== undefined\n    ? attrs.selectable(checked)\n    : false;\n  const inactive = attrs.disabled || !selectable;\n  return { checked, inactive };\n};\n\nexport const getInitialState = (vnode, createStream) => {\n  const attrs = vnode.attrs;\n  const isChecked = attrs.defaultChecked !== undefined\n    ? attrs.defaultChecked\n    : attrs.checked || false;\n  const checked = createStream(isChecked);\n\n  const notifyChange = (e, isChecked) => {\n    if (attrs.onChange) {\n      attrs.onChange({\n        event: e,\n        checked: isChecked,\n        value: attrs.value\n      });\n    } \n  };\n\n  const onChange = e => {\n    let isChecked = e.currentTarget.checked;\n    if (attrs.type === \"radio\") {\n      // do not set directly\n    } else {\n      checked(isChecked);\n    }\n    notifyChange(e, isChecked);\n  };\n\n  const toggle = e => {\n    const newChecked = !checked();\n    checked(newChecked);\n    notifyChange(e, newChecked);\n  };\n\n  return {\n    checked,\n    toggle,\n    onChange,\n    redrawOnUpdate: createStream.merge([checked])\n  };\n};\n\nexport const createProps = (vnode, { keys: k }) => {\n  const attrs = vnode.attrs;\n  const state = vnode.state;\n  const { checked, inactive } = currentState(attrs, state);\n  return Object.assign(\n    {},\n    filterSupportedAttributes(attrs),\n    {\n      className: [\n        classes.component,\n        attrs.instanceClass, // for instance pe-checkbox-control\n        checked ? classes.on : classes.off,\n        attrs.disabled ? classes.disabled : null,\n        inactive ? classes.inactive : null,\n        classForSize(classes, attrs.size),\n        attrs.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        attrs.tone === \"light\" ? \"pe-light-tone\" : null,\n        attrs.className || attrs[k.class],\n      ].join(\" \")\n    }\n  );\n};\n\nexport const createContent = (vnode, { renderer: h, keys: k, ViewControl }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  const { checked, inactive } = currentState(attrs, state);\n  const viewControlClickHandler = attrs.events && attrs.events[k.onclick];\n  const viewControlKeyDownHandler = attrs.events && attrs.events[k.onkeydown]\n    ? attrs.events[k.onkeydown]\n    : e => {\n      if (e.key === \"Enter\") {\n        if (viewControlClickHandler) {\n          viewControlClickHandler(e);\n        } else {\n          state.toggle(e);\n        }\n      }\n    };\n\n  return h(\"label\",\n    Object.assign(\n      {},\n      {\n        className: classes.formLabel,\n      },\n      viewControlClickHandler && {\n        [k.onclick]: e => (\n          e.preventDefault(),\n          viewControlClickHandler(e)\n        )\n      }\n    ),\n    [\n      h(ViewControl, Object.assign(\n        {},\n        attrs,\n        {\n          inactive,\n          checked,\n          key: \"control\",\n          events: {\n            // Only use key down event; click events are handled by input element\n            [k.onkeydown]: viewControlKeyDownHandler\n          }\n        }\n      )),\n      attrs.label\n        ? h(`.${classes.label}`,\n          { key: \"label\" },\n          attrs.label\n        )\n        : null,\n      h(\"input\", Object.assign(\n        {},\n        attrs.events,\n        {\n          name: attrs.name,\n          type: attrs.type,\n          value: attrs.value,\n          checked\n        },\n        attrs.disabled || inactive\n          ? { disabled: \"disabled\" }\n          : {\n            [k.onchange]: state.onChange\n          }\n      ))\n    ]\n  );\n};\n","import classes from \"polythene-css-classes/selection-control\";\n\nconst CONTENT = [\n  { iconType: \"iconOn\", className: classes.buttonOn},\n  { iconType: \"iconOff\", className: classes.buttonOff}\n];\n\nexport const getElement = vnode =>\n  vnode.attrs.element || `.${classes.box}`;\n\nconst createIcon = (h, iconType, attrs, className) => (\n  // if attrs.iconOn/attrs.iconOff is passed, use that icon options object and ignore size\n  // otherwise create a new object\n  Object.assign(\n    {},\n    {\n      className,\n      key: iconType\n    },\n    attrs[iconType]\n      ? attrs[iconType]\n      : { svg: { content: h.trust(attrs.icons[iconType]) } },\n    attrs.icon,\n    attrs.size\n      ? { size: attrs.size }\n      : null\n  )\n);\n\nexport const createContent = (vnode, { renderer: h, Icon, IconButton }) => {\n  const attrs = vnode.attrs;\n  return h(IconButton, Object.assign(\n    {},\n    {\n      element: \"div\",\n      key: attrs.key,\n      className: classes.button,\n      content: CONTENT.map(o =>\n        h(Icon, createIcon(h, o.iconType, attrs, o.className))\n      ),\n      ripple: { center: true },\n      disabled: attrs.disabled,\n      events: attrs.events,\n      inactive: attrs.inactive\n    },\n    attrs.iconButton // for example for hover behaviour\n  ));\n};\n"],"names":["component","formLabel","input","label","disabled","inactive","large","medium","off","on","regular","small","box","button","buttonOff","buttonOn","getElement","vnode","attrs","element","currentState","state","checked","undefined","selectable","getInitialState","createStream","isChecked","defaultChecked","notifyChange","e","onChange","event","value","currentTarget","type","toggle","newChecked","redrawOnUpdate","merge","createProps","k","keys","filterSupportedAttributes","className","classes","instanceClass","classForSize","size","tone","class","join","createContent","h","renderer","ViewControl","viewControlClickHandler","events","onclick","viewControlKeyDownHandler","onkeydown","key","preventDefault","name","onchange","CONTENT","iconType","createIcon","svg","content","trust","icons","icon","Icon","IconButton","_extends","map","o","ripple","center","iconButton"],"mappings":"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"}