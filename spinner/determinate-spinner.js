"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _mithril=require("mithril"),_mithril2=_interopRequireDefault(_mithril),_spinner=require("polythene/spinner/spinner"),_spinner2=_interopRequireDefault(_spinner);require("polythene/spinner/theme/determinate/theme");var _config=require("polythene/spinner/theme/determinate/config"),_config2=_interopRequireDefault(_config),_easing=require("polythene/common/easing"),_easing2=_interopRequireDefault(_easing),CSS_CLASSES={block:"pe-spinner-determinate",animation:"pe-spinner-determinate__animation",circle:"pe-spinner-determinate__circle",circleRight:"pe-spinner-determinate__circle--right",circleLeft:"pe-spinner-determinate__circle--left"},sizeFromType=function(){var type=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"regular";return _config2.default["size_"+type]},percentageValue=function(min,max,percentage){return min+(max-min)*percentage},rotateCircle=function(el,min,max,percentage){var style=el.style;style.transform=style["-webkit-transform"]=style["-moz-transform"]=style["-ms-transform"]=style["-o-transform"]="rotate("+percentageValue(min,max,percentage)+"deg)"},animate=function(ctrlEl,size,percentage){var animationEl=ctrlEl.querySelector("."+CSS_CLASSES.animation),animationElStyle=animationEl.style;percentage<.5?animationElStyle.clip="rect(0px, "+size+"px, "+size+"px, "+size/2+"px)":animationElStyle.clip="rect(auto, auto, auto, auto)";var leftCircle=ctrlEl.querySelector("."+CSS_CLASSES.circleLeft),rightCircle=ctrlEl.querySelector("."+CSS_CLASSES.circleRight);leftCircle.style.clip=rightCircle.style.clip="rect(0px, "+size/2+"px, "+size+"px, 0px)",rotateCircle(rightCircle,0,180,Math.min(1,2*percentage)),rotateCircle(leftCircle,0,360,percentage)},handlePercentage=function(percentage,ctrl,size){var opts=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};ctrl.el&&(ctrl._previousPercentage=ctrl._previousPercentage||0,opts.animated&&ctrl._previousPercentage!==percentage?!function(){var STEP_DURATION=1e3*opts.updateDuration,start=null,step=function step(timestamp){start||(start=timestamp);var progress=timestamp-start,stepPercentage=1/STEP_DURATION*progress,newPercentage=ctrl._previousPercentage+stepPercentage*(percentage-ctrl._previousPercentage);animate(ctrl.el,size,_easing2.default.easeInOutQuad(newPercentage)),ctrl._previousPercentage=newPercentage,start&&progress<STEP_DURATION?window.requestAnimationFrame(step):start=null};window.requestAnimationFrame(step)}():(animate(ctrl.el,size,percentage),ctrl._previousPercentage=percentage))},component={view:function(ctrl){var opts=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},size=sizeFromType(opts.type);return opts.content=(0,_mithril2.default)("div",{class:CSS_CLASSES.animation},[(0,_mithril2.default)("div",{class:[CSS_CLASSES.circle,CSS_CLASSES.circleLeft].join(" ")}),(0,_mithril2.default)("div",{class:[CSS_CLASSES.circle,CSS_CLASSES.circleRight].join(" ")})]),opts.class=[CSS_CLASSES.block,opts.class].join(" "),opts.getPercentage=function(percentage,ctrl){return handlePercentage(percentage,ctrl,size,opts)},_mithril2.default.component(_spinner2.default,opts)}};exports.default=component,module.exports=exports.default;
//# sourceMappingURL=determinate-spinner.js.map