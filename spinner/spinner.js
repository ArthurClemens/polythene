"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),require("polythene/common/object.assign");var _mithril=require("mithril"),_mithril2=_interopRequireDefault(_mithril),_transition=require("polythene/common/transition"),_transition2=_interopRequireDefault(_transition),_shadow=require("polythene/shadow/shadow"),_shadow2=_interopRequireDefault(_shadow);require("polythene/spinner/theme/common/theme");var CSS_CLASSES={block:"pe-spinner",placeholder:"pe-spinner--placeholder",animation:"pe-spinner__animation",visible:"pe-spinner--visible",small:"pe-spinner--small",regular:"pe-spinner--regular",medium:"pe-spinner--medium",large:"pe-spinner--large",fab:"pe-spinner--fab",raised:"pe-spinner--raised",permanent:"pe-spinner--permanent",singleColor:"pe-spinner--single-color",animated:"pe-spinner--animated"},typeClasses={small:CSS_CLASSES.small,regular:CSS_CLASSES.regular,medium:CSS_CLASSES.medium,large:CSS_CLASSES.large,fab:CSS_CLASSES.fab},classForType=function(){var mode=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"regular";return typeClasses[mode]},show=function(ctrl,opts){if(!ctrl.isTransitioning)return ctrl.isTransitioning=!0,_transition2.default.show(Object.assign({},opts,{el:ctrl.el,showClass:CSS_CLASSES.visible})).then(function(){ctrl.isTransitioning=!1,ctrl.visible=!0})},hide=function(ctrl,opts){if(!ctrl.isTransitioning)return ctrl.isTransitioning=!0,_transition2.default.hide(Object.assign({},opts,{el:ctrl.el,afterHide:function(){return ctrl.el.style.display="none"},showClass:CSS_CLASSES.visible})).then(function(){ctrl.isTransitioning=!1,ctrl.visible=!1,ctrl.hide=!1,_mithril2.default.redraw()})},notifyState=function(ctrl,opts){if(opts.percentage&&opts.getPercentage){var percentage=void 0;percentage="function"==typeof opts.percentage?opts.percentage():opts.percentage,opts.getPercentage(percentage,ctrl,opts)}},createView=function(ctrl){var opts=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},tag=opts.tag||"div",props=Object.assign({},{class:[CSS_CLASSES.block,classForType(opts.type),opts.singleColor?CSS_CLASSES.singleColor:null,opts.raised?CSS_CLASSES.raised:null,opts.animated?CSS_CLASSES.animated:null,opts.permanent?CSS_CLASSES.permanent:null,opts.class].join(" "),id:opts.id||"",config:function(el,inited,context,vdom){inited||(opts.config&&opts.config(el,inited,context,vdom),ctrl.el=el,notifyState(ctrl,opts),opts.permanent||setTimeout(function(){show(ctrl,opts)},0))}},opts.events?opts.events:null);notifyState(ctrl,opts),ctrl.hide&&setTimeout(function(){hide(ctrl,opts)},0);var content=[opts.raised&&opts.content?_mithril2.default.component(_shadow2.default,{z:opts.z}):null,opts.content||(0,_mithril2.default)("div",{class:CSS_CLASSES.animation},"Specific spinner missing")];return(0,_mithril2.default)(tag,props,[opts.before,content,opts.after])},delay=function(opts,mode){var value=opts[mode];return value!==!0&&!isNaN(value)&&1e3*parseFloat(value,10)},component={controller:function(){var opts=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{el:null,isTransitioning:!1,visible:opts.permanent||!1,hide:!1,percentage:0}},view:function(ctrl){var opts=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(ctrl.visible){if(void 0!==opts.show&&!opts.show||opts.hide){var hideDelay=delay(opts,"hide");hideDelay?setTimeout(function(){return ctrl.hide=!0,_mithril2.default.redraw()},hideDelay):ctrl.hide=!0}}else if(void 0!==opts.hide&&!opts.hide||opts.show){var showDelay=delay(opts,"show");showDelay?setTimeout(function(){return ctrl.visible=!0,_mithril2.default.redraw()},showDelay):ctrl.visible=!0}return ctrl.visible?createView(ctrl,opts):(0,_mithril2.default)("span",{class:CSS_CLASSES.placeholder})}};exports.default=component,module.exports=exports.default;
//# sourceMappingURL=spinner.js.map