'use strict';Object.defineProperty(exports,'__esModule',{value:!0}),require('polythene/common/object.assign');var _mithril=require('mithril'),_mithril2=_interopRequireDefault(_mithril),_shadow=require('polythene/shadow/shadow'),_shadow2=_interopRequireDefault(_shadow),_icon=require('polythene/icon/icon'),_icon2=_interopRequireDefault(_icon),_listTile=require('polythene/list-tile/list-tile'),_listTile2=_interopRequireDefault(_listTile);require('polythene/card/theme/theme');function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}var CSS_CLASSES={block:'pe-card',overlay:'pe-card__overlay',overlaySheet:'pe-card__overlay--sheet',overlayContent:'pe-card__overlay__content',mediaDimmer:'pe-card__media__dimmer',mediaCropX:'pe-card__media--crop-x',mediaCropY:'pe-card__media--crop-y',media:'pe-card__media',header:'pe-card__header',headerTitle:'pe-card__header-title',title:'pe-card__title',subtitle:'pe-card__subtitle',text:'pe-card__text',primary:'pe-card__primary',primaryMedia:'pe-card__primary__media',actions:'pe-card__actions',actionsHorizontal:'pe-card__actions--horizontal',actionsVertical:'pe-card__actions--vertical',actionsJustified:'pe-card__actions--justified',actionsBordered:'pe-card__actions--borders',mediaRatioSquare:'pe-card__media--square',mediaRatioLandscape:'pe-card__media--landscape',primaryHasMedia:'pe-card__primary--media',mediaSmall:'pe-card__media--small',mediaRegular:'pe-card__media--regular',mediaMedium:'pe-card__media--medium',mediaLarge:'pe-card__media--large'},imageRatios={landscape:16/9,square:1},createOverlay=function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},b=a.tag||'div',c=a.content.map(function(d){var e=Object.keys(d)[0];return contentMap[e](d)});return{tag:'div',attrs:{'class':[CSS_CLASSES.overlay,a.sheet?CSS_CLASSES.overlaySheet:null].join(' ')},children:[(0,_mithril2.default)(b,{class:[CSS_CLASSES.overlayContent,a.class].join(' ')},c),{tag:'div',attrs:{'class':CSS_CLASSES.mediaDimmer},children:[]}]}},createText=function(a){var b=a.text||{},c=b.tag||'div';return(0,_mithril2.default)(c,{class:[CSS_CLASSES.text,b.class].join(' ')},b.content)},mediaTypeClasses={small:CSS_CLASSES.mediaSmall,regular:CSS_CLASSES.mediaRegular,medium:CSS_CLASSES.mediaMedium,large:CSS_CLASSES.mediaLarge},mediaClassForType=function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:'regular';return mediaTypeClasses[a]},createMedia=function(a){var b=a.media||{},c=b.ratio||'landscape',d=b.origin||'center',e=b.tag||'div';return(0,_mithril2.default)(e,{class:[CSS_CLASSES.media,mediaClassForType(b.type),'landscape'===c?CSS_CLASSES.mediaRatioLandscape:CSS_CLASSES.mediaRatioSquare,b.class].join(' '),config:function initImage(g,i){if(!i){var j=g.querySelector('img');j&&(j.onload=function(){var k=this.naturalWidth,l=this.naturalHeight,m=k/l,n=m<imageRatios[c]?CSS_CLASSES.mediaCropX:CSS_CLASSES.mediaCropY;if(j.className=n,'start'!==d){var p=g.clientWidth,q=g.clientHeight;if(m<imageRatios[c]){var s=q-p/m,t=Math.ceil('center'===d?s/2:s);this.style.marginTop=t+'px'}else{var s=p-q*m,t=Math.ceil('center'===d?s/2:s);this.style.marginLeft=t+'px'}}})}}},[b.content,b.overlay?createOverlay(b.overlay):{tag:'div',attrs:{'class':CSS_CLASSES.mediaDimmer},children:[]}])},createHeader=function(a){var b=a.header||{};return _mithril2.default.component(_listTile2.default,Object.assign({},b,{class:[CSS_CLASSES.header,b.class].join(' ')},b.icon?{front:_mithril2.default.component(_icon2.default,b.icon)}:null))},actionLayoutClasses={horizontal:CSS_CLASSES.actionsHorizontal,vertical:CSS_CLASSES.actionsVertical,justified:CSS_CLASSES.actionsJustified},actionClassForLayout=function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:'horizontal';return actionLayoutClasses[a]},createActions=function(a){var b=a.actions||{},c=b.tag||'div';return(0,_mithril2.default)(c,{class:[CSS_CLASSES.actions,actionClassForLayout(b.layout),b.class].join(' ')},b.content)},createPrimary=function(a){var b,c,d,e=a.primary||{},f=e.tag||'div',g=!1,i={title:function title(j){return j.attrs?j:{tag:'div',attrs:{'class':CSS_CLASSES.title},children:[j.title?j.title:null,j.subtitle?{tag:'div',attrs:{'class':CSS_CLASSES.subtitle},children:[j.subtitle]}:null]}},media:function media(j){return g=!0,{tag:'div',attrs:{'class':CSS_CLASSES.primaryMedia},children:[createMedia({media:j})]}},actions:function actions(j){return createActions({actions:j})}};return b=Array.isArray(e.content)?e.content.map(function(j){return c=Object.keys(j)[0],d=j[c],i[c]?i[c](d):j}):[e.title?i.title({title:e.title,subtitle:e.subtitle}):null,e.media?i.media(e.media):null,e.actions?i.actions(e.actions):null,e.content?e.content:null],(0,_mithril2.default)(f,{class:[CSS_CLASSES.primary,g?CSS_CLASSES.primaryHasMedia:null].join(' ')},b)},contentMap={text:createText,media:createMedia,header:createHeader,primary:createPrimary,actions:createActions},createView=function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},c=b.tag||b.url?'a':'div',d=Object.assign({},{class:[CSS_CLASSES.block,b.class].join(' '),id:b.id||'',config:b.config},b.url?b.url:null,b.events?b.events:null),e=void 0;return Array.isArray(b.content)?(e=b.content.map(function(f){var g=Object.keys(f)[0];return contentMap[g](f)}),e.unshift(_mithril2.default.component(_shadow2.default,{z:a.z(),animated:!0}))):e=[_mithril2.default.component(_shadow2.default,{z:a.z(),animated:!0}),b.content],(0,_mithril2.default)(c,d,[b.before,e,b.after])},component={controller:function controller(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},b=a.z===void 0?1:a.z;return{z:_mithril2.default.prop(b)}},view:function view(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return createView(a,b)}};exports.default=component,module.exports=exports['default'];
//# sourceMappingURL=card.js.map