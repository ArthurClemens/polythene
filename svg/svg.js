'use strict';Object.defineProperty(exports,'__esModule',{value:!0}),require('polythene/common/object.assign');var _mithril=require('mithril'),_mithril2=_interopRequireDefault(_mithril);require('polythene/svg/theme/theme');function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}var CSS_CLASSES={block:'pe-svg'},globalCache={},createView=function(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},c=void 0,d=void 0,e=b.tag||'div',f=Object.assign({},{class:[CSS_CLASSES.block,b.class].join(' '),id:b.id||'',config:b.config},b.events?b.events:null);if(b.content)c=b.content;else{var g=b.src;a.path()===g?(d=a.svg(),d=d||'',c=_mithril2.default.trust(d),preloadNext(a,b)):(d=globalCache[g],d?(c=_mithril2.default.trust(d),preloadNext(a,b)):(a.path(g),loadSvg(g,a,b).then(_mithril2.default.redraw)))}return(0,_mithril2.default)(e,f,[b.before,c,b.after])},loadSvg=function(a,b,c){var d=3<arguments.length&&arguments[3]!==void 0&&arguments[3];if('undefined'!=typeof System&&System.import){var e=System.normalizeSync(a);return System.import(e).then(function(f){d?(globalCache[a]=f,b.preloadingIndex++,preloadNext(b,c)):b.svg(f)})}return'undefined'!=typeof console&&console.log&&console.log('polythene/svg: System not found.'),{then:function then(){'undefined'!=typeof console&&console.log&&console.log('polythene/svg: System not found.')}}},preloadNext=function(a,b){if(a.preloadingItems&&!(a.preloadingIndex>=a.preloadingItems.length)){var c=a.preloadingItems[a.preloadingIndex];globalCache[c]?(a.preloadingIndex++,preloadNext(a,b)):loadSvg(c,a,b,!0)}},component={controller:function controller(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return _mithril2.default.redraw.strategy('none'),{path:_mithril2.default.prop(''),svg:_mithril2.default.prop(''),preloadingItems:a.preload,preloadingIndex:0}},view:function view(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return createView(a,b)}};exports.default=component,module.exports=exports['default'];
//# sourceMappingURL=svg.js.map