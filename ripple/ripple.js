'use strict';Object.defineProperty(exports,'__esModule',{value:!0});var _mithril=require('mithril'),_mithril2=_interopRequireDefault(_mithril),_polythene=require('polythene/polythene/polythene'),_polythene2=_interopRequireDefault(_polythene),_transitionEvent=require('polythene/common/transition-event'),_transitionEvent2=_interopRequireDefault(_transitionEvent),_isomorphic=require('polythene/common/isomorphic'),_isomorphic2=_interopRequireDefault(_isomorphic);require('polythene/ripple/theme/theme');function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}var transitionEvent=(0,_transitionEvent2.default)(),DEFAULT_START_OPACITY=0.2,OPACITY_DECAY_VELOCITY=0.35,CSS_CLASSES={ripple:'pe-ripple',waves:'pe-ripple__waves',mask:'pe-ripple__mask',constrained:'pe-ripple--constrained',animated:'pe-ripple__waves--animated'},makeRipple=function(a,b){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{};if(!_isomorphic2.default.isServer()){var d=b.ripple(),f=b.waves(),g=d.offsetWidth,i=d.offsetHeight,j=Math.sqrt(g*g+i*i),k=d.getBoundingClientRect(),l=_polythene2.default.isTouch&&a.touches?a.touches[0].pageX:a.clientX,m=_polythene2.default.isTouch&&a.touches?a.touches[0].pageY:a.clientY,n=c.center?k.left+k.width/2:l,o=c.center?k.top+k.height/2:m,p=n-k.left-j/2,q=o-k.top-j/2,r=void 0===c.initialOpacity?DEFAULT_START_OPACITY:c.initialOpacity,s=void 0===c.opacityDecayVelocity?OPACITY_DECAY_VELOCITY:c.opacityDecayVelocity,u=window.getComputedStyle(d).color,v=function onEnd(A){f.classList.remove(CSS_CLASSES.animated),f.removeEventListener(transitionEvent,v,!1),c.end&&c.end(A)};f.classList.remove(CSS_CLASSES.animated);var z=f.style;z.width=z.height=j+'px',z.top=q+'px',z.left=p+'px',z['animation-duration']=z['-webkit-animation-duration']=z['-moz-animation-duration']=z['-o-animation-duration']=1/s*r+'s',z.backgroundColor=u,z.opacity=r,f.addEventListener(transitionEvent,v,!1),c.start&&c.start(a),f.classList.add(CSS_CLASSES.animated)}},createView=function(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};if(b.disabled)return{tag:'div',attrs:{},children:[]};var f=b.tag||'div',g={class:[CSS_CLASSES.ripple,!1===b.constrained?null:CSS_CLASSES.constrained,b.class].join(' '),id:b.id||'',config:function initRipple(j,k,l){if(!k){a.ripple(j);var m=j.parentElement;b.inactive||function(){var n=function onClick(p){makeRipple(p,a,b)},o=_polythene2.default.isTouch?'click':'mouseup';m.addEventListener(o,n,!1),l.onunload=function(){m.removeEventListener(o,n,!1)}}()}}},i={tag:'div',attrs:{'class':CSS_CLASSES.mask},children:[{tag:'div',attrs:{'class':CSS_CLASSES.waves,config:function initWaves(j,k){k||a.waves(j)}},children:[]}]};return(0,_mithril2.default)(f,g,i)},component={controller:function controller(){return{ripple:_mithril2.default.prop(),waves:_mithril2.default.prop(),delegate:_mithril2.default.prop()}},view:function view(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return createView(a,b)}};exports.default=component,module.exports=exports['default'];
//# sourceMappingURL=ripple.js.map