"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),require("polythene/common/object.assign");var _mithril=require("mithril"),_mithril2=_interopRequireDefault(_mithril),_timer=require("polythene/common/timer"),_timer2=_interopRequireDefault(_timer),_transition=require("polythene/common/transition"),_transition2=_interopRequireDefault(_transition),CSS_CLASSES={content:"pe-notification__content",title:"pe-notification__title",multilineTitle:"pe-notification__title--multiline",action:"pe-notification__action",horizontal:"pe-notification--horizontal",vertical:"pe-notification--vertical"},DEFAULT_TIME_OUT=3,pause=function(ctrl){ctrl.isPaused=!0,ctrl.timer&&ctrl.timer.pause()},unpause=function(ctrl){ctrl.isPaused=!1,ctrl.timer&&ctrl.timer.resume()},stopTimer=function(ctrl){ctrl.timer&&ctrl.timer.stop()},show=function(ctrl,opts){stopTimer(ctrl);var id=ctrl.instanceId;return ctrl.isTransitioning=!0,_transition2.default.show(Object.assign({},opts,ctrl.transitions.show(ctrl,opts))).then(function(){ctrl.isTransitioning=!1,ctrl.didShow&&ctrl.didShow(id);var timeout=opts.timeout;if(0===timeout);else{var timeoutSeconds=void 0!==timeout?timeout:DEFAULT_TIME_OUT;ctrl.timer=new _timer2.default(function(){hide(ctrl,opts)},1e3*timeoutSeconds)}})},hide=function(ctrl,opts){stopTimer(ctrl);var id=ctrl.instanceId;return ctrl.isTransitioning=!0,_transition2.default.hide(Object.assign({},opts,ctrl.transitions.hide(ctrl,opts))).then(function(){stopTimer(ctrl),ctrl.isTransitioning=!1,ctrl.didHide&&ctrl.didHide(id),_mithril2.default.redraw()})},createView=function(ctrl){var opts=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},tag=opts.tag||"div",props={class:[ctrl.class,"vertical"===opts.layout?CSS_CLASSES.vertical:CSS_CLASSES.horizontal,opts.class].join(" "),id:opts.id||"",config:function(el,inited,context,vdom){inited||(opts.config&&opts.config(el,inited,context,vdom),ctrl.el=el,ctrl.containerEl=document.querySelector(opts.containerSelector||".pe-notification__holder"),show(ctrl,opts))},onclick:function(e){e.preventDefault()}},titleConfig=function(el,inited){if(!inited){var height=el.getBoundingClientRect().height,lineHeight=parseInt(window.getComputedStyle(el).lineHeight,10),paddingTop=parseInt(window.getComputedStyle(el).paddingTop,10),paddingBottom=parseInt(window.getComputedStyle(el).paddingBottom,10);height>lineHeight+paddingTop+paddingBottom&&el.classList.add(CSS_CLASSES.multilineTitle)}},title=opts.title,content=(0,_mithril2.default)("div",{class:CSS_CLASSES.content},[title?(0,_mithril2.default)("div",{class:CSS_CLASSES.title,config:titleConfig},title):null,opts.action?(0,_mithril2.default)("div",{class:CSS_CLASSES.action},[opts.action]):null]);return(0,_mithril2.default)(tag,props,content)},component={controller:function(){var instanceData=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign({},instanceData,{el:null,containerEl:null,dismissEl:null,isTransitioning:!1,timer:null,isPaused:!1})},view:function(ctrl,instanceData){var opts="function"==typeof instanceData.opts?instanceData.opts():instanceData.opts;return instanceData.hide&&!ctrl.isTransitioning&&hide(ctrl,opts),instanceData.pause&&!ctrl.isPaused?pause(ctrl,opts):instanceData.unpause&&ctrl.isPaused&&unpause(ctrl,opts),createView(ctrl,opts)}};exports.default=component,module.exports=exports.default;
//# sourceMappingURL=notification-instance.js.map